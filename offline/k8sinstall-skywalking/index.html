<!doctype html><html data-bs-theme=light itemscope itemtype=http://schema.org/WebPage lang=zh-hans><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=manifest href=https://www.jobcher.com/manifest.webmanifest><link rel=canonical type=text/html href=https://www.jobcher.com/k8sinstall-skywalking/><link rel=alternate type=application/rss+xml href=https://www.jobcher.com/k8sinstall-skywalking/index.xml><meta name=description content="介绍 Apache SkyWalking 是一个应用性能监控（APM）系统，用于分布式系统的监控、追踪和诊断。它提供了完整的可观测性解决方案，帮助开发者和运维人员快速定位和解决分布式系统中的性能问题。
组件说明 OAP (Observability Analysis Platform): 核心分析平台，负责数据收集、分"><link rel=icon href=/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_16x16_resize_box_3.png sizes=16x16 type=image/png><link rel=icon href=/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_32x32_resize_box_3.png sizes=32x32 type=image/png><link rel=icon href=/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_150x150_resize_box_3.png sizes=150x150 type=image/png><link rel=apple-touch-icon href=/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_180x180_resize_box_3.png sizes=180x180 type=image/png><link rel=icon href=/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_192x192_resize_box_3.png sizes=192x192 type=image/png><link rel=mask-icon href=/mask-icon.svg color=#000000><meta property="og:title" content="Kubernetes — skywalking + banyanDB APM监控部署"><meta property="og:description" content="介绍 Apache SkyWalking 是一个应用性能监控（APM）系统，用于分布式系统的监控、追踪和诊断。它提供了完整的可观测性解决方案，帮助开发者和运维人员快速定位和解决分布式系统中的性能问题。
组件说明 OAP (Observability Analysis Platform): 核心分析平台，负责数据收集、分析和存储 UI: Web 界面，用于可视化和查询监控数据 BanyanDB: 高性能时序数据库，作为 SkyWalking 的存储后端 etcd: 分布式键值存储，BanyanDB 使用它来存储元数据 功能特性 分布式追踪: 自动收集和关联分布式系统的调用链，支持跨服务追踪 服务拓扑: 可视化服务之间的依赖关系，实时展示服务调用图 性能指标: 收集服务的性能指标（延迟、吞吐量、错误率等） 日志关联: 将日志与追踪数据关联，通过 TraceID 快速定位问题 告警机制: 支持基于指标的告警规则配置 部署 前置要求 在开始部署之前，请确保满足以下要求：
Kubernetes 集群: 版本 1.20+ 命名空间: 已创建 logging 命名空间（或根据实际情况修改） 存储: 确保节点有足够的存储空间（建议至少 10Gi） 网络: 确保 Pod 之间可以正常通信 提示: 本文档中的所有资源都部署在 logging 命名空间中，如需使用其他命名空间，请修改相应的 YAML 文件。
部署 BanyanDB BanyanDB 是 SkyWalking 的存储后端，需要先部署 BanyanDB 和 etcd。
1. 部署 etcd etcd 用于存储 BanyanDB 的元数据。"><meta property="og:type" content="article"><meta property="og:url" content="https://www.jobcher.com/k8sinstall-skywalking/"><meta property="og:image" content="https://www.jobcher.com/images/skywalking.webp"><meta property="article:section" content="blog"><meta property="article:published_time" content="2026-01-09T00:00:00+00:00"><meta property="article:modified_time" content="2026-02-04T14:57:45+08:00"><meta itemprop=name content="Kubernetes — skywalking + banyanDB APM监控部署"><meta itemprop=description content="介绍 Apache SkyWalking 是一个应用性能监控（APM）系统，用于分布式系统的监控、追踪和诊断。它提供了完整的可观测性解决方案，帮助开发者和运维人员快速定位和解决分布式系统中的性能问题。
组件说明 OAP (Observability Analysis Platform): 核心分析平台，负责数据收集、分析和存储 UI: Web 界面，用于可视化和查询监控数据 BanyanDB: 高性能时序数据库，作为 SkyWalking 的存储后端 etcd: 分布式键值存储，BanyanDB 使用它来存储元数据 功能特性 分布式追踪: 自动收集和关联分布式系统的调用链，支持跨服务追踪 服务拓扑: 可视化服务之间的依赖关系，实时展示服务调用图 性能指标: 收集服务的性能指标（延迟、吞吐量、错误率等） 日志关联: 将日志与追踪数据关联，通过 TraceID 快速定位问题 告警机制: 支持基于指标的告警规则配置 部署 前置要求 在开始部署之前，请确保满足以下要求：
Kubernetes 集群: 版本 1.20+ 命名空间: 已创建 logging 命名空间（或根据实际情况修改） 存储: 确保节点有足够的存储空间（建议至少 10Gi） 网络: 确保 Pod 之间可以正常通信 提示: 本文档中的所有资源都部署在 logging 命名空间中，如需使用其他命名空间，请修改相应的 YAML 文件。
部署 BanyanDB BanyanDB 是 SkyWalking 的存储后端，需要先部署 BanyanDB 和 etcd。
1. 部署 etcd etcd 用于存储 BanyanDB 的元数据。"><meta itemprop=datePublished content="2026-01-09T00:00:00+00:00"><meta itemprop=dateModified content="2026-02-04T14:57:45+08:00"><meta itemprop=wordCount content="2261"><meta itemprop=image content="https://www.jobcher.com/images/skywalking.webp"><meta itemprop=keywords content="k8s,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.jobcher.com/images/skywalking.webp"><meta name=twitter:title content="Kubernetes — skywalking + banyanDB APM监控部署"><meta name=twitter:description content="介绍 Apache SkyWalking 是一个应用性能监控（APM）系统，用于分布式系统的监控、追踪和诊断。它提供了完整的可观测性解决方案，帮助开发者和运维人员快速定位和解决分布式系统中的性能问题。
组件说明 OAP (Observability Analysis Platform): 核心分析平台，负责数据收集、分析和存储 UI: Web 界面，用于可视化和查询监控数据 BanyanDB: 高性能时序数据库，作为 SkyWalking 的存储后端 etcd: 分布式键值存储，BanyanDB 使用它来存储元数据 功能特性 分布式追踪: 自动收集和关联分布式系统的调用链，支持跨服务追踪 服务拓扑: 可视化服务之间的依赖关系，实时展示服务调用图 性能指标: 收集服务的性能指标（延迟、吞吐量、错误率等） 日志关联: 将日志与追踪数据关联，通过 TraceID 快速定位问题 告警机制: 支持基于指标的告警规则配置 部署 前置要求 在开始部署之前，请确保满足以下要求：
Kubernetes 集群: 版本 1.20+ 命名空间: 已创建 logging 命名空间（或根据实际情况修改） 存储: 确保节点有足够的存储空间（建议至少 10Gi） 网络: 确保 Pod 之间可以正常通信 提示: 本文档中的所有资源都部署在 logging 命名空间中，如需使用其他命名空间，请修改相应的 YAML 文件。
部署 BanyanDB BanyanDB 是 SkyWalking 的存储后端，需要先部署 BanyanDB 和 etcd。
1. 部署 etcd etcd 用于存储 BanyanDB 的元数据。"><title>Kubernetes — skywalking + banyanDB APM监控部署 - 博客 - 打工人日志</title>
<link href="/css/hb.66f9669d4d623b674d972fe91a879e1ef415baf0e8f5f6f80f90c16c9e7b7508.css" rel=stylesheet><script src=/js/init.577d4e90bff5601d5756fcf799b0e53568bf56cea3b80fe43f66c9d365e8100c.js integrity="sha256-V31OkL/1YB1XVvz3mbDlNWi/Vs6juA/kP2bJ02XoEAw="></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-01J740DER5"></script><meta name=keywords content="jobcher,jobcher.,打工人日报,打工人,打工人日志,教程,安装,文档,文件,运维,前端,后端,全栈,工程,代码,系统,程序,函数,网络,工具,中文,win10,微信,javascript,java,excel,prompt,ppt,密码,数据,iPhone,安卓,word,自动,qq,js,app,www,wifi,com,wifi,ios,u盘,数据库,Linux,Kubernetes,k8s,抖音,博客,Apple,blog,prompt,github,web3.0,web,work,工作,docker,prometheus,监控,福利,天涯,CSDN,csdn,CSDN博客,CSDN学院,CSDN论坛,CSDN直播,博客园,51cto,简书,阿里云,腾讯云,华为云,阿里网盘"><script defer src=https://umami.jobcher.com/script.js data-website-id=3d2d4c2a-c0d3-475c-a7ba-da5db582a101></script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","jt8h3n2olz")</script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-01J740DER5")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3185871258903631" crossorigin=anonymous></script><link rel=stylesheet href=/css/search.ee67fb063f2e4be8eff1be9d9806279c3c3d43570b6266c759281faac3804b11.css></head><body><noscript><div class="alert alert-danger text-center rounded-0" role=alert><svg aria-hidden="true" class="bi bi-exclamation-square-fillbi bi-exclamation-square-fill hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm6 4c.535.0.954.462.9.995l-.35 3.507a.552.552.0 01-1.1.0L7.1 4.995A.905.905.0 018 4m.002 6a1 1 0 110 2 1 1 0 010-2"/></svg>你的浏览器不支持 JavaScript。</div></noscript><header class=hb-header><nav class="hb-header-nav navbar navbar-expand-lg"><div class=container-fluid><a class="navbar-brand d-flex align-items-center" href=/><img src=https://www.jobcher.com/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_0x64_resize_box_3.png alt=Logo width=64 height=64 class="hb-header-logo d-inline-block align-text-top me-2">打工人日志</a><div class="d-flex order-5"><div class="search-modal-toggle hb-header-search-form position-relative d-flex ms-lg-1"><button type=button class="hb-header-search-icon border-0 bg-transparent px-2" aria-label="Toggle search">
<svg aria-hidden="true" class="bi bi-searchbi bi-search hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1.007 1.007.0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
</button>
<input class="form-control rounded-5 d-none d-lg-block ms-lg-1" id=hb-header-search-input placeholder=搜索>
<span class="hb-header-search-keys position-absolute d-none d-lg-block"><kbd>CTRL</kbd>
<kbd>K</kbd></span></div><button class="navbar-toggler border-0 shadow-none" type=button data-bs-toggle=offcanvas data-bs-target=#hb-header-content aria-controls=hb-header-content aria-label="Toggle navigation"><svg aria-hidden="true" class="bi bi-three-dotsbi bi-three-dots hi-svg-inline" fill="currentcolor" height="1.25em" viewBox="0 0 16 16" width="1.25em" xmlns="http://www.w3.org/2000/svg"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg></button></div><div class="offcanvas offcanvas-lg offcanvas-end" tabindex=-1 id=hb-header-content aria-labelledby=hb-header-content-label><div class=offcanvas-header><h5 class=offcanvas-title id=hb-header-content-label>打工人日志</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label=Close></button></div><div class=offcanvas-body><ul class="hb-header-menus navbar-nav flex-row flex-wrap"><li class="hb-header-menu nav-item col-6 col-lg-auto"><a class=nav-link href=https://k8sbook.jobcher.com/ target=_blank rel=external><svg aria-hidden="true" class="bi bi-bookbi bi-book hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M1 2.828c.885-.37 2.154-.769 3.388-.893 1.33-.134 2.458.063 3.112.752v9.746c-.935-.53-2.12-.603-3.213-.493-1.18.12-2.37.461-3.287.811V2.828zm7.5-.141c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492V2.687zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5.0 000 2.5v11a.5.5.0 00.707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5.0 00.78.0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5.0 0016 13.5v-11a.5.5.0 00-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"/></svg>k8s文档</a></li><li class="hb-header-menu nav-item col-6 col-lg-auto"><a class=nav-link href=https://nav.jobcher.com/ target=_blank rel=external><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" style="color:red" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 48C141.1 48 48 141.1 48 256v40c0 13.3-10.7 24-24 24S0 309.3.0 296V256C0 114.6 114.6.0 256 0S512 114.6 512 256V400.1c0 48.6-39.4 88-88.1 88L313.6 488c-8.3 14.3-23.8 24-41.6 24H240c-26.5.0-48-21.5-48-48s21.5-48 48-48h32c17.8.0 33.3 9.7 41.6 24l110.4.1c22.1.0 40-17.9 40-40V256c0-114.9-93.1-208-208-208zM144 208h16c17.7.0 32 14.3 32 32V352c0 17.7-14.3 32-32 32H144c-35.3.0-64-28.7-64-64V272c0-35.3 28.7-64 64-64zm224 0c35.3.0 64 28.7 64 64v48c0 35.3-28.7 64-64 64H352c-17.7.0-32-14.3-32-32V240c0-17.7 14.3-32 32-32h16z"/></svg>导航</a></li><li class="hb-header-menu nav-item col-6 col-lg-auto"><a class=nav-link href=https://realip.jobcher.com/ target=_blank rel=external><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" style="color:green" viewBox="0 0 640 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M88.2 309.1c9.8-18.3 6.8-40.8-7.5-55.8C59.4 230.9 48 204 48 176c0-63.5 63.8-128 160-128s160 64.5 160 128-63.8 128-160 128c-13.1.0-25.8-1.3-37.8-3.6-10.4-2-21.2-.6-30.7 4.2-4.1 2.1-8.3 4.1-12.6 6-16 7.2-32.9 13.5-49.9 18 2.8-4.6 5.4-9.1 7.9-13.6 1.1-1.9 2.2-3.9 3.2-5.9zM0 176c0 41.8 17.2 80.1 45.9 110.3-.9 1.7-1.9 3.5-2.8 5.1-10.3 18.4-22.3 36.5-36.6 52.1-6.6 7-8.3 17.2-4.6 25.9C5.8 378.3 14.4 384 24 384c43 0 86.5-13.3 122.7-29.7 4.8-2.2 9.6-4.5 14.2-6.8 15.1 3 30.9 4.5 47.1 4.5 114.9.0 208-78.8 208-176S322.9.0 208 0 0 78.8.0 176zM432 480c16.2.0 31.9-1.6 47.1-4.5 4.6 2.3 9.4 4.6 14.2 6.8C529.5 498.7 573 512 616 512c9.6.0 18.2-5.7 22-14.5s2-19-4.6-25.9c-14.2-15.6-26.2-33.7-36.6-52.1-.9-1.7-1.9-3.4-2.8-5.1 28.8-30.3 46-68.6 46-110.4.0-94.4-87.9-171.5-198.2-175.8 4.1 15.2 6.2 31.2 6.2 47.8v.6c87.2 6.7 144 67.5 144 127.4.0 28-11.4 54.9-32.7 77.2-14.3 15-17.3 37.6-7.5 55.8 1.1 2 2.2 4 3.2 5.9 2.5 4.5 5.2 9 7.9 13.6-17-4.5-33.9-10.7-49.9-18-4.3-1.9-8.5-3.9-12.6-6-9.5-4.8-20.3-6.2-30.7-4.2-12.1 2.4-24.7 3.6-37.8 3.6-61.7.0-110-26.5-136.8-62.3-16 5.4-32.8 9.4-50 11.8C279 439.8 350 480 432 480z"/></svg>ip检测</a></li><li class="hb-header-menu dropdown nav-item col-12 col-lg-auto active"><a class="nav-link pe-0 d-inline-flex align-items-center active" href=/blog/ aria-current=page><svg aria-hidden="true" class="hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 512 512" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M192 32c0 17.7 14.3 32 32 32 123.7.0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1.0 224 0c-17.7.0-32 14.3-32 32zm0 96c0 17.7 14.3 32 32 32 70.7.0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7.0-32 14.3-32 32zM96 144c0-26.5-21.5-48-48-48S0 117.5.0 144V368c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144H128v96h16c26.5.0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48V144z"/></svg>博客</a>
<a class="nav-link ps-0 d-inline-flex" href=# id=header-menu-blog role=button data-bs-toggle=dropdown aria-expanded=false><span class=visually-hidden>Toggle Dropdown</span><svg aria-hidden="true" class="bi bi-chevron-compact-downbi bi-chevron-compact-down hi-svg-inline" fill="currentcolor" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1.553 6.776a.5.5.0 01.67-.223L8 9.44l5.776-2.888a.5.5.0 11.448.894l-6 3a.5.5.0 01-.448.0l-6-3a.5.5.0 01-.223-.67z"/></svg></a><ul class="hb-header-submenus dropdown-menu" aria-labelledby=header-menu-blog data-bs-popper=none><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://www.jobcher.com/series/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-columnsbi bi-columns hi-svg-inline" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v12a1 1 0 01-1 1H1a1 1 0 01-1-1zm8.5.0v8H15V2zm0 9v3H15v-3zm-1-9H1v3h6.5zM1 14h6.5V6H1z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">专栏</div><p class="dropdown-item-desc mb-0 text-wrap">所有专栏。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://www.jobcher.com/authors/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-pencilbi bi-pencil hi-svg-inline" fill="currentcolor" height="2em" style="color:#0f5e97" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M12.146.146a.5.5.0 01.708.0l3 3a.5.5.0 010 .708l-10 10a.5.5.0 01-.168.11l-5 2a.5.5.0 01-.65-.65l2-5a.5.5.0 01.11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5.0 01.5.5v.5h.5a.5.5.0 01.5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5.0 015 12.5V12h-.5a.5.5.0 01-.5-.5V11h-.5a.5.5.0 01-.468-.325z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">作者</div><p class="dropdown-item-desc mb-0 text-wrap">作者列表。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://www.jobcher.com/categories/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-folderbi bi-folder hi-svg-inline" fill="currentcolor" height="2em" style="color:orange" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M.54 3.87.5 3a2 2 0 012-2h3.672a2 2 0 011.414.586l.828.828A2 2 0 009.828 3h3.982a2 2 0 011.992 2.181l-.637 7A2 2 0 0113.174 14H2.826A2 2 0 01.835 12.181l-.637-7a1.99 1.99.0 01.342-1.31zM2.19 4a1 1 0 00-.996 1.09l.637 7a1 1 0 00.995.91h10.348a1 1 0 00.995-.91l.637-7A1 1 0 0013.81 4H2.19zm4.69-1.707A1 1 0 006.172 2H2.5a1 1 0 00-1 .981l.006.139C1.72 3.042 1.95 3 2.19 3h5.396l-.707-.707z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">分类</div><p class="dropdown-item-desc mb-0 text-wrap">所有分类。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://www.jobcher.com/archives/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-archivebi bi-archive hi-svg-inline" fill="currentcolor" height="2em" style="color:384955" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1v7.5A2.5 2.5.0 0112.5 15h-9A2.5 2.5.0 011 12.5V5A1 1 0 010 4zm2 3v7.5A1.5 1.5.0 003.5 14h9a1.5 1.5.0 001.5-1.5V5zm13-3H1v2h14zM5 7.5a.5.5.0 01.5-.5h5a.5.5.0 010 1h-5A.5.5.0 015 7.5"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">归档</div><p class="dropdown-item-desc mb-0 text-wrap">文章归档。</p></div></a></li><li><a class="hb-header-submenu dropdown-item d-flex align-items-center" href=https://www.jobcher.com/tags/><div class="dropdown-item-icon d-flex align-items-center bg-body-secondary bg-gradient rounded me-2 p-2"><svg aria-hidden="true" class="bi bi-tagsbi bi-tags hi-svg-inline" fill="currentcolor" height="2em" style="color:green" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path d="M3 2v4.586l7 7L14.586 9l-7-7zM2 2a1 1 0 011-1h4.586a1 1 0 01.707.293l7 7a1 1 0 010 1.414l-4.586 4.586a1 1 0 01-1.414.0l-7-7A1 1 0 012 6.586z"/><path d="M5.5 5a.5.5.0 110-1 .5.5.0 010 1m0 1a1.5 1.5.0 100-3 1.5 1.5.0 000 3M1 7.086a1 1 0 00.293.707L8.75 15.25l-.043.043a1 1 0 01-1.414.0l-7-7A1 1 0 010 7.586V3a1 1 0 011-1z"/></svg></div><div class=dropdown-item-content><div class="dropdown-item-title mb-1">标签</div><p class="dropdown-item-desc mb-0 text-wrap">所有标签。</p></div></a></li></ul></li><li class="hb-header-menu nav-item col-6 col-lg-auto"><a class=nav-link href=https://www.jobcher.com/new/><svg aria-hidden="true" class="bi bi-newspaperbi bi-newspaper hi-svg-inline hb-header-menu-icon me-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 2.5A1.5 1.5.0 011.5 1h11A1.5 1.5.0 0114 2.5v10.528c0 .3-.05.654-.238.972h.738a.5.5.0 00.5-.5v-9a.5.5.0 011 0v9A1.5 1.5.0 0114.5 15H1.497A1.497 1.497.0 010 13.5zM12 14c.37.0.654-.211.853-.441.092-.106.147-.279.147-.531V2.5a.5.5.0 00-.5-.5h-11a.5.5.0 00-.5.5v11c0 .278.223.5.497.5z"/><path d="M2 3h10v2H2zm0 3h4v3H2zm0 4h4v1H2zm0 2h4v1H2zm5-6h2v1H7zm3 0h2v1h-2zM7 8h2v1H7zm3 0h2v1h-2zm-3 2h2v1H7zm3 0h2v1h-2zm-3 2h2v1H7zm3 0h2v1h-2z"/></svg>日报</a></li></ul><ul class="hb-header-panel navbar-nav flex-row flex-wrap"><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><hr class="d-lg-none my-2 text-body-50"></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href=https://github.com/jobcher target=_blank rel="nofollow me" title=GitHub><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
<span class="hb-social-text d-lg-none ms-1">GitHub</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href=/index.xml target=_blank rel="nofollow me" title=RSS><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg>
<span class="hb-social-text d-lg-none ms-1">RSS</span></a></li><li class="nav-item col-6 col-lg-auto d-flex align-items-center"><a class="hb-social btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-center align-items-center" href=https://twitter.com/jobcher1 target=_blank rel="nofollow me" title=推特><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1em" role="img" viewBox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636.0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94.0 010 19.539a9.88 9.88.0 007.287-2.041 4.93 4.93.0 01-4.6-3.42 4.916 4.916.0 002.223-.084A4.926 4.926.0 01.96 9.167v-.062a4.887 4.887.0 002.235.616A4.928 4.928.0 011.67 3.148 13.98 13.98.0 0011.82 8.292a4.929 4.929.0 018.39-4.49 9.868 9.868.0 003.128-1.196A4.941 4.941.0 0121.173 5.33 9.828 9.828.0 0024 4.555a10.019 10.019.0 01-2.457 2.549z"/></svg>
<span class="hb-social-text d-lg-none ms-1">推特</span></a></li><li class="nav-item py-2 py-lg-1 col-12 col-lg-auto"><div class="vr d-none d-lg-flex h-100 mx-lg-2 text-body"></div><hr class="d-lg-none my-2 text-body-50"></li><li class="language-picker nav-item dropdown col-6 col-lg-auto d-flex flex-column justify-content-center"><a class="btn btn-link nav-link py-2 px-0 px-lg-2 d-flex justify-content-start justify-content-lg-center align-items-center" href=# role=button data-bs-toggle=dropdown aria-expanded=false title="Language picker"><svg aria-hidden="true" class="bi bi-globebi bi-globe hi-svg-inline my-1 language-picker-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 8a8 8 0 1116 0A8 8 0 010 8m7.5-6.923c-.67.204-1.335.82-1.887 1.855A7.97 7.97.0 005.145 4H7.5zM4.09 4a9.267 9.267.0 01.64-1.539 6.7 6.7.0 01.597-.933A7.025 7.025.0 002.255 4zm-.582 3.5c.03-.877.138-1.718.312-2.5H1.674a6.958 6.958.0 00-.656 2.5zM4.847 5a12.5 12.5.0 00-.338 2.5H7.5V5zM8.5 5v2.5h2.99A12.495 12.495.0 0011.153 5zM4.51 8.5a12.5 12.5.0 00.337 2.5H7.5V8.5zm3.99.0V11h2.653c.187-.765.306-1.608.338-2.5zM5.145 12c.138.386.295.744.468 1.068.552 1.035 1.218 1.65 1.887 1.855V12zm.182 2.472a6.696 6.696.0 01-.597-.933A9.268 9.268.0 014.09 12H2.255a7.024 7.024.0 003.072 2.472M3.82 11a13.652 13.652.0 01-.312-2.5h-2.49c.062.89.291 1.733.656 2.5zm6.853 3.472A7.024 7.024.0 0013.745 12H11.91a9.27 9.27.0 01-.64 1.539 6.688 6.688.0 01-.597.933M8.5 12v2.923c.67-.204 1.335-.82 1.887-1.855.173-.324.33-.682.468-1.068zm3.68-1h2.146c.365-.767.594-1.61.656-2.5h-2.49A13.65 13.65.0 0112.18 11zm2.802-3.5A6.959 6.959.0 0014.326 5H12.18c.174.782.282 1.623.312 2.5zM11.27 2.461c.247.464.462.98.64 1.539h1.835a7.024 7.024.0 00-3.072-2.472c.218.284.418.598.597.933zM10.855 4a7.966 7.966.0 00-.468-1.068C9.835 1.897 9.17 1.282 8.5 1.077V4z"/></svg>
<span class="d-lg-none ms-1">简体中文</span></a><ul class="language-picker-menu dropdown-menu dropdown-menu-end"><li><a class="language-picker-item dropdown-item active" href=https://www.jobcher.com/>简体中文</a></li><li><a class="language-picker-item dropdown-item" href=https://www.jobcher.com/en/>English</a></li></ul></li><li class="theme-toggle nav-item dropdown col-6 col-lg-auto d-flex flex-column justify-content-center"><button class="btn btn-link btn-theme-toggle nav-link py-2 px-0 px-lg-2 d-flex justify-content-start justify-content-lg-center align-items-center" data-style=switch aria-expanded=false title=主题>
<svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1 theme-toggle-icon" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1zm0 1A8 8 0 118 0a8 8 0 010 16"/></svg>
<span class="d-lg-none ms-1 theme-name">主题</span></button><ul class="theme-toggle-menu dropdown-menu dropdown-menu-end"><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name=自动 data-bs-theme-value=auto>
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-circle-halfbi bi-circle-half hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 15A7 7 0 108 1zm0 1A8 8 0 118 0a8 8 0 010 16"/></svg>
</span>自动</button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name=暗色 data-bs-theme-value=dark>
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-moon-starsbi bi-moon-stars hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278M4.858 1.311A7.269 7.269.0 001.025 7.71c0 4.02 3.279 7.276 7.319 7.276a7.316 7.316.0 005.205-2.162c-.337.042-.68.063-1.029.063-4.61.0-8.343-3.714-8.343-8.29.0-1.167.242-2.278.681-3.286z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></svg>
</span>暗色</button></li><li><button class="theme-toggle-item dropdown-item d-flex align-items-center justify-content-center" data-bs-theme-name=亮色 data-bs-theme-value=light>
<span class="theme-toggle-item-icon me-1 d-flex align-items-center"><svg aria-hidden="true" class="bi bi-brightness-highbi bi-brightness-high hi-svg-inline my-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 11a3 3 0 110-6 3 3 0 010 6m0 1a4 4 0 100-8 4 4 0 000 8M8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0m0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13m8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5M3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8m10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0m-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707M4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></svg>
</span>亮色</button></li></ul></li></ul></div></div></div></nav></header><div class="hb-main container"><div class=hb-blog-main-container><div class=hb-blog-main><div class="container-fluid px-0 mb-4"><nav aria-label=breadcrumb><ol class="hb-breadcrumb breadcrumb"><li class=breadcrumb-item><a href=/ title=打工人日志>主页</a></li><li class=breadcrumb-item><a href=/blog/ title=博客>博客</a></li><li class="breadcrumb-item active" aria-current=page><a href=/k8sinstall-skywalking/ title="Kubernetes — skywalking + banyanDB APM监控部署">Kubernetes — skywalking + banyanDB APM监控部署</a></li></ol></nav></div><div class="hb-blog-post position-relative"><div class="hb-blog-post-intro hb-module mb-2"><h1 class=hb-blog-post-title>Kubernetes — skywalking + banyanDB APM监控部署</h1><div class=hb-blog-post-meta><a class="hb-blog-post-author-link text-decoration-none" href=/authors/jobcher/ title=jobcher><picture><img class="hb-blog-author-img rounded-circle" src="https://avatars.githubusercontent.com/u/31278050?v=4" alt=jobcher loading=lazy>
</picture></a><span class=hb-blog-post-date>2026年1月9日</span>
<span class=hb-blog-post-reading-time>11 分钟阅读</span>
<span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-category badge bg-secondary text-decoration-none fw-normal me-1" href=/categories/k8s/>k8s</a>
</span><span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-series badge bg-secondary text-decoration-none fw-normal me-1" href=/series/k8s%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97/>k8s入门系列</a>
</span><span class=hb-blog-post-taxonomy-meta><a class="hb-blog-post-taxonomy hb-blog-post-taxonomy-tag badge bg-secondary text-decoration-none fw-normal me-1" href=/tags/k8s/>k8s</a></span></div></div><div class="hb-blog-post-toc text-body-secondary position-sticky overflow-y-auto"><div class="hb-module pb-1"><div class="h6 d-none d-md-block">本页内容</div><hr class="d-none d-md-block"><div class="d-grid d-block d-md-none mb-2"><button class="btn btn-light d-flex align-items-center justify-content-between collapsed" type=button data-bs-toggle=collapse data-bs-target=.hb-blog-post-toc-collapse aria-expanded=false aria-controls=collapse-toc>
<span>本页内容</span><svg aria-hidden="true" class="bi bi-chevron-expandbi bi-chevron-expand hi-svg-inline ms-2" fill="currentcolor" height="1.25rem" viewBox="0 0 16 16" width="1.25rem" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3.646 9.146a.5.5.0 01.708.0L8 12.793l3.646-3.647a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 010-.708zm0-2.292a.5.5.0 00.708.0L8 3.207l3.646 3.647a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 000 .708z"/></svg></button></div><div class="px-2 px-md-0"><div id=collapse-toc class="collapse hb-blog-post-toc-collapse"><nav id=TableOfContents><ul><li><a href=#介绍>介绍</a><ul><li><a href=#组件说明>组件说明</a></li><li><a href=#功能特性>功能特性</a></li></ul></li><li><a href=#部署>部署</a><ul><li><a href=#前置要求>前置要求</a></li><li><a href=#部署-banyandb>部署 BanyanDB</a></li><li><a href=#部署-skywalking>部署 SkyWalking</a></li></ul></li><li><a href=#配置-skywalking-agent>配置 SkyWalking Agent</a><ul><li><a href=#1-添加-maven-依赖>1. 添加 Maven 依赖</a></li><li><a href=#2-配置-logback>2. 配置 Logback</a></li><li><a href=#3-kubernetes-部署配置>3. Kubernetes 部署配置</a></li></ul></li><li><a href=#验证和测试>验证和测试</a><ul><li><a href=#1-访问-skywalking-ui>1. 访问 SkyWalking UI</a></li><li><a href=#2-测试应用追踪>2. 测试应用追踪</a></li><li><a href=#3-常见问题排查>3. 常见问题排查</a></li></ul></li><li><a href=#总结>总结</a></li></ul></nav></div></div></div></div><div class=hb-blog-post-main><div class="hb-module p-0 text-center"><picture><img class="hb-featured-img img-fluid p-1 bg-body-secondary border w-100" src=https://www.jobcher.com/images/skywalking.3e20b6db7b61579e8a9781d19101df1e.webp alt="Kubernetes — skywalking + banyanDB APM监控部署" height=620 width=1058 data-src=https://www.jobcher.com/images/skywalking.3e20b6db7b61579e8a9781d19101df1e.webp data-width=1058 data-height=620></picture></div><div class="hb-blog-post-content hb-module" data-bs-spy=scroll data-bs-target=#TableOfContents><h2 id=介绍>介绍</h2><p>Apache SkyWalking 是一个应用性能监控（APM）系统，用于分布式系统的监控、追踪和诊断。它提供了完整的可观测性解决方案，帮助开发者和运维人员快速定位和解决分布式系统中的性能问题。</p><h3 id=组件说明>组件说明</h3><ul><li><strong>OAP (Observability Analysis Platform)</strong>: 核心分析平台，负责数据收集、分析和存储</li><li><strong>UI</strong>: Web 界面，用于可视化和查询监控数据</li><li><strong>BanyanDB</strong>: 高性能时序数据库，作为 SkyWalking 的存储后端</li><li><strong>etcd</strong>: 分布式键值存储，BanyanDB 使用它来存储元数据</li></ul><h3 id=功能特性>功能特性</h3><ul><li><strong>分布式追踪</strong>: 自动收集和关联分布式系统的调用链，支持跨服务追踪</li><li><strong>服务拓扑</strong>: 可视化服务之间的依赖关系，实时展示服务调用图</li><li><strong>性能指标</strong>: 收集服务的性能指标（延迟、吞吐量、错误率等）</li><li><strong>日志关联</strong>: 将日志与追踪数据关联，通过 TraceID 快速定位问题</li><li><strong>告警机制</strong>: 支持基于指标的告警规则配置</li></ul><h2 id=部署>部署</h2><h3 id=前置要求>前置要求</h3><p>在开始部署之前，请确保满足以下要求：</p><ol><li><strong>Kubernetes 集群</strong>: 版本 1.20+</li><li><strong>命名空间</strong>: 已创建 <code>logging</code> 命名空间（或根据实际情况修改）</li><li><strong>存储</strong>: 确保节点有足够的存储空间（建议至少 10Gi）</li><li><strong>网络</strong>: 确保 Pod 之间可以正常通信</li></ol><blockquote><p><strong>提示</strong>: 本文档中的所有资源都部署在 <code>logging</code> 命名空间中，如需使用其他命名空间，请修改相应的 YAML 文件。</p></blockquote><h3 id=部署-banyandb>部署 BanyanDB</h3><p>BanyanDB 是 SkyWalking 的存储后端，需要先部署 BanyanDB 和 etcd。</p><h4 id=1-部署-etcd>1. 部署 etcd</h4><p>etcd 用于存储 BanyanDB 的元数据。</p><p><strong>创建 etcd 持久化存储卷</strong></p><p>创建文件 <code>banyandb-etcd-pv.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolume</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd-data-pv</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>  </span><span class=nt>capacity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>    </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>5Gi</span><span class=w> </span><span class=c># 存储大小</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>  </span><span class=nt>persistentVolumeReclaimPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Retain</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>host-banyandb-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/data/banyandb-etcd</span><span class=w> </span><span class=c># 存储位置</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>DirectoryOrCreate</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>  </span><span class=nt>nodeAffinity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>      </span><span class=nt>nodeSelectorTerms</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>        </span>- <span class=nt>matchExpressions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>            </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes.io/hostname</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>              </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=l>In</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>              </span><span class=nt>values</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>                </span>- <span class=l>worker-1 </span><span class=w> </span><span class=c># 修改为你要存储的节点名称</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><strong>注意</strong>: 请根据实际情况修改 <code>worker-1</code> 为你的节点名称，并确保该节点存在 <code>/data/banyandb-etcd</code> 目录或具有创建权限。</p></blockquote><p><strong>创建 etcd 持久化存储声明</strong></p><p>创建文件 <code>banyandb-etcd-pvc.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolumeClaim</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd-data</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>5Gi </span><span class=w> </span><span class=c>#存储大小</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>host-banyandb-etcd</span><span class=w>
</span></span></span></code></pre></div><p><strong>创建 etcd 服务</strong></p><p>创建文件 <code>banyandb-etcd-service.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>clusterIP</span><span class=p>:</span><span class=w> </span><span class=l>None</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>client</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2379</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>2379</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>peer</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2380</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>2380</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd</span><span class=w>
</span></span></span></code></pre></div><p><strong>创建 etcd StatefulSet</strong></p><p>创建文件 <code>banyandb-etcd-statefulset.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>etcd</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>quay.io/coreos/etcd:v3.5.9</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>client</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>              </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>2379</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>peer</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w>              </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>2380</span><span class=w>
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_NAME</span><span class=w>
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;banyandb-etcd-0&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_DATA_DIR</span><span class=w>
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>/etcd-data</span><span class=w>
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_LISTEN_CLIENT_URLS</span><span class=w>
</span></span></span><span class=line><span class=ln>31</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://0.0.0.0:2379&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_ADVERTISE_CLIENT_URLS</span><span class=w>
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://banyandb-etcd-0.banyandb-etcd:2379&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_LISTEN_PEER_URLS</span><span class=w>
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://0.0.0.0:2380&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span class=w>
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://banyandb-etcd-0.banyandb-etcd:2380&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>38</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_INITIAL_CLUSTER</span><span class=w>
</span></span></span><span class=line><span class=ln>39</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;banyandb-etcd-0=http://banyandb-etcd-0.banyandb-etcd:2380&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>40</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_INITIAL_CLUSTER_TOKEN</span><span class=w>
</span></span></span><span class=line><span class=ln>41</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;banyandb-etcd-cluster&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>42</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ETCD_INITIAL_CLUSTER_STATE</span><span class=w>
</span></span></span><span class=line><span class=ln>43</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;new&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>44</span><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>45</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>data</span><span class=w>
</span></span></span><span class=line><span class=ln>46</span><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/etcd-data</span><span class=w>
</span></span></span><span class=line><span class=ln>47</span><span class=cl><span class=w>          </span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>48</span><span class=cl><span class=w>            </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>49</span><span class=cl><span class=w>              </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/health</span><span class=w>
</span></span></span><span class=line><span class=ln>50</span><span class=cl><span class=w>              </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2379</span><span class=w>
</span></span></span><span class=line><span class=ln>51</span><span class=cl><span class=w>            </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=ln>52</span><span class=cl><span class=w>            </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=ln>53</span><span class=cl><span class=w>            </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=ln>54</span><span class=cl><span class=w>            </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln>55</span><span class=cl><span class=w>          </span><span class=nt>readinessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>56</span><span class=cl><span class=w>            </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>57</span><span class=cl><span class=w>              </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/health</span><span class=w>
</span></span></span><span class=line><span class=ln>58</span><span class=cl><span class=w>              </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2379</span><span class=w>
</span></span></span><span class=line><span class=ln>59</span><span class=cl><span class=w>            </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=ln>60</span><span class=cl><span class=w>            </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=ln>61</span><span class=cl><span class=w>            </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=ln>62</span><span class=cl><span class=w>            </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln>63</span><span class=cl><span class=w>          </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>64</span><span class=cl><span class=w>            </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>65</span><span class=cl><span class=w>              </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;256Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>66</span><span class=cl><span class=w>              </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;100m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>67</span><span class=cl><span class=w>            </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>68</span><span class=cl><span class=w>              </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;512Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>69</span><span class=cl><span class=w>              </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;500m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>70</span><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>71</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>data</span><span class=w>
</span></span></span><span class=line><span class=ln>72</span><span class=cl><span class=w>          </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>73</span><span class=cl><span class=w>            </span><span class=nt>claimName</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-etcd-data</span><span class=w>
</span></span></span></code></pre></div><h4 id=2-部署-banyandb>2. 部署 BanyanDB</h4><p><strong>创建 BanyanDB 持久化存储卷</strong></p><p>创建文件 <code>banyandb-pv.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolume</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-data-pv</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>  </span><span class=nt>capacity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>    </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>5Gi</span><span class=w> </span><span class=c>#存储大小</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>  </span><span class=nt>persistentVolumeReclaimPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Retain</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>host-banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/data/banyandb</span><span class=w> </span><span class=c>#存储位置</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>DirectoryOrCreate</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>  </span><span class=nt>nodeAffinity</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>    </span><span class=nt>required</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>      </span><span class=nt>nodeSelectorTerms</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>        </span>- <span class=nt>matchExpressions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>            </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>kubernetes.io/hostname</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>              </span><span class=nt>operator</span><span class=p>:</span><span class=w> </span><span class=l>In</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>              </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>                </span>- <span class=l>worker-1 </span><span class=w> </span><span class=c># 修改为你要存储的节点名称</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><strong>注意</strong>: 请根据实际情况修改 <code>worker-1</code> 为你的节点名称，并确保该节点存在 <code>/data/banyandb</code> 目录或具有创建权限。</p></blockquote><p><strong>创建 BanyanDB 持久化存储声明</strong></p><p>创建文件 <code>banyandb-pvc.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolumeClaim</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-data</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>5Gi</span><span class=w> </span><span class=c>#存储大小</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>storageClassName</span><span class=p>:</span><span class=w> </span><span class=l>host-banyandb</span><span class=w>
</span></span></span></code></pre></div><p><strong>创建 BanyanDB 服务</strong></p><p>创建文件 <code>banyandb-service.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>grpc</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>17912</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>17912</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>17913</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>17913</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span></code></pre></div><p><strong>创建 BanyanDB StatefulSet</strong></p><p>创建文件 <code>banyandb-statefulset.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>      </span><span class=nt>initContainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>wait-for-etcd</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox:1.35</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-c&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>            </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=sd>              until nc -z banyandb-etcd 2379; do
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=sd>                echo &#34;Waiting for etcd to be ready...&#34;
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=sd>                sleep 2
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=sd>              done
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=sd>              echo &#34;etcd is ready!&#34;</span><span class=w>              
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>apache/skywalking-banyandb:0.9.0</span><span class=w>
</span></span></span><span class=line><span class=ln>31</span><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;standalone&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>grpc</span><span class=w>
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=w>              </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>17912</span><span class=w>
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=w>              </span><span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>17913</span><span class=w>
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>38</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_STANDALONE</span><span class=w>
</span></span></span><span class=line><span class=ln>39</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>40</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_ETCD_ENDPOINTS</span><span class=w>
</span></span></span><span class=line><span class=ln>41</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://banyandb-etcd:2379&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>42</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_GRPC_HOST</span><span class=w>
</span></span></span><span class=line><span class=ln>43</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>44</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_GRPC_PORT</span><span class=w>
</span></span></span><span class=line><span class=ln>45</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;17912&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>46</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_HTTP_HOST</span><span class=w>
</span></span></span><span class=line><span class=ln>47</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>48</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_HTTP_PORT</span><span class=w>
</span></span></span><span class=line><span class=ln>49</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;17913&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>50</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>BANYANDB_DATA_DIR</span><span class=w>
</span></span></span><span class=line><span class=ln>51</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/data&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>52</span><span class=cl><span class=w>          </span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>53</span><span class=cl><span class=w>            </span><span class=nt>tcpSocket</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>54</span><span class=cl><span class=w>              </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>17913</span><span class=w>
</span></span></span><span class=line><span class=ln>55</span><span class=cl><span class=w>            </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>60</span><span class=w>
</span></span></span><span class=line><span class=ln>56</span><span class=cl><span class=w>            </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=ln>57</span><span class=cl><span class=w>            </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=ln>58</span><span class=cl><span class=w>            </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln>59</span><span class=cl><span class=w>          </span><span class=nt>readinessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>60</span><span class=cl><span class=w>            </span><span class=nt>tcpSocket</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>61</span><span class=cl><span class=w>              </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>17913</span><span class=w>
</span></span></span><span class=line><span class=ln>62</span><span class=cl><span class=w>            </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=ln>63</span><span class=cl><span class=w>            </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=ln>64</span><span class=cl><span class=w>            </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=ln>65</span><span class=cl><span class=w>            </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln>66</span><span class=cl><span class=w>          </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>67</span><span class=cl><span class=w>            </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>68</span><span class=cl><span class=w>              </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;512Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>69</span><span class=cl><span class=w>              </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;250m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>70</span><span class=cl><span class=w>            </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>71</span><span class=cl><span class=w>              </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2Gi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>72</span><span class=cl><span class=w>              </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1000m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>73</span><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>74</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>data</span><span class=w>
</span></span></span><span class=line><span class=ln>75</span><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/data</span><span class=w>
</span></span></span><span class=line><span class=ln>76</span><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>77</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>data</span><span class=w>
</span></span></span><span class=line><span class=ln>78</span><span class=cl><span class=w>          </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>79</span><span class=cl><span class=w>            </span><span class=nt>claimName</span><span class=p>:</span><span class=w> </span><span class=l>banyandb-data</span><span class=w>
</span></span></span></code></pre></div><h4 id=3-部署-banyandb-组件>3. 部署 BanyanDB 组件</h4><p>在包含所有 BanyanDB YAML 文件的目录下执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>kubectl apply -f .
</span></span></code></pre></div><p>验证部署状态：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># 检查 etcd 状态</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>kubectl get pods -n logging <span class=p>|</span> grep banyandb-etcd
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1># 检查 BanyanDB 状态</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>kubectl get pods -n logging <span class=p>|</span> grep banyandb
</span></span><span class=line><span class=ln>6</span><span class=cl>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=c1># 查看 BanyanDB 日志</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>kubectl logs -n logging -l <span class=nv>app</span><span class=o>=</span>banyandb --tail<span class=o>=</span><span class=m>50</span>
</span></span></code></pre></div><blockquote><p><strong>提示</strong>: 确保 etcd 和 BanyanDB 都处于 <code>Running</code> 状态后再继续部署 SkyWalking。</p></blockquote><hr><h3 id=部署-skywalking>部署 SkyWalking</h3><h4 id=1-部署-oap-server>1. 部署 OAP Server</h4><p>OAP (Observability Analysis Platform) 是 SkyWalking 的核心组件，负责数据收集、分析和存储。</p><p><strong>创建 OAP Deployment</strong></p><p>创建文件 <code>oap-deployment.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>initContainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>wait-for-banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox:1.35</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-c&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>            </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=sd>              echo &#34;Waiting for BanyanDB to be ready...&#34;
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=sd>              # 等待 BanyanDB 服务可用
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=sd>              until nc -z banyandb.logging.svc.cluster.local 17912; do
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=sd>                echo &#34;Waiting for BanyanDB gRPC port...&#34;
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=sd>                sleep 3
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=sd>              done
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=sd>              # 额外等待几秒，确保 gRPC 服务完全启动
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=sd>              sleep 5
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=sd>              echo &#34;BanyanDB is ready!&#34;</span><span class=w>              
</span></span></span><span class=line><span class=ln>31</span><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>oap</span><span class=w>
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>apache/skywalking-oap-server:10.3.0</span><span class=w>
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>11800</span><span class=w>
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>12800</span><span class=w>
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>38</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_STORAGE</span><span class=w>
</span></span></span><span class=line><span class=ln>39</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>banyandb</span><span class=w>
</span></span></span><span class=line><span class=ln>40</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_STORAGE_BANYANDB_TARGETS</span><span class=w>
</span></span></span><span class=line><span class=ln>41</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>banyandb:17912</span><span class=w>
</span></span></span><span class=line><span class=ln>42</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_STORAGE_BANYANDB_GRPC_TLS_ENABLED</span><span class=w>
</span></span></span><span class=line><span class=ln>43</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>44</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_OPTS</span><span class=w>
</span></span></span><span class=line><span class=ln>45</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;-Xms1g -Xmx1g&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>46</span><span class=cl><span class=w>            </span><span class=c># 启用 Log Receiver 模块 - 接收来自应用的日志</span><span class=w>
</span></span></span><span class=line><span class=ln>47</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_RECEIVER_LOGGING</span><span class=w>
</span></span></span><span class=line><span class=ln>48</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=ln>49</span><span class=cl><span class=w>            </span><span class=c># 启用 Log Analyzer 模块 - 分析日志数据</span><span class=w>
</span></span></span><span class=line><span class=ln>50</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_LOG_ANALYZER</span><span class=w>
</span></span></span><span class=line><span class=ln>51</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=ln>52</span><span class=cl><span class=w>            </span><span class=c># LAL 文件配置</span><span class=w>
</span></span></span><span class=line><span class=ln>53</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_LOG_LAL_FILES</span><span class=w>
</span></span></span><span class=line><span class=ln>54</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>default</span><span class=w>
</span></span></span><span class=line><span class=ln>55</span><span class=cl><span class=w>            </span><span class=c># 日志接收器 gRPC 处理器配置（与 agent 9.5.0 的 GRPCLogClientAppender 兼容）</span><span class=w>
</span></span></span><span class=line><span class=ln>56</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_RECEIVER_LOGGING_DEFAULT_HANDLERS</span><span class=w>
</span></span></span><span class=line><span class=ln>57</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>grpc</span><span class=w>
</span></span></span><span class=line><span class=ln>58</span><span class=cl><span class=w>            </span><span class=c># 日志接收器 gRPC 服务配置</span><span class=w>
</span></span></span><span class=line><span class=ln>59</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_RECEIVER_LOGGING_DEFAULT_GRPC_HOST</span><span class=w>
</span></span></span><span class=line><span class=ln>60</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=w>
</span></span></span><span class=line><span class=ln>61</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_RECEIVER_LOGGING_DEFAULT_GRPC_PORT</span><span class=w>
</span></span></span><span class=line><span class=ln>62</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;11800&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>63</span><span class=cl><span class=w>            </span><span class=c># 日志接收器 gRPC 最大消息大小（支持大日志）</span><span class=w>
</span></span></span><span class=line><span class=ln>64</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_RECEIVER_LOGGING_DEFAULT_GRPC_MAX_MESSAGE_SIZE</span><span class=w>
</span></span></span><span class=line><span class=ln>65</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;10485760&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>66</span><span class=cl><span class=w>            </span><span class=c># 日志接收器 gRPC 最大连接数</span><span class=w>
</span></span></span><span class=line><span class=ln>67</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_RECEIVER_LOGGING_DEFAULT_GRPC_MAX_CONCURRENT_STREAMS</span><span class=w>
</span></span></span><span class=line><span class=ln>68</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;100&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>69</span><span class=cl><span class=w>          </span><span class=nt>livenessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>70</span><span class=cl><span class=w>            </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>71</span><span class=cl><span class=w>              </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/healthcheck</span><span class=w>
</span></span></span><span class=line><span class=ln>72</span><span class=cl><span class=w>              </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>12800</span><span class=w>
</span></span></span><span class=line><span class=ln>73</span><span class=cl><span class=w>            </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>60</span><span class=w>
</span></span></span><span class=line><span class=ln>74</span><span class=cl><span class=w>            </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=ln>75</span><span class=cl><span class=w>            </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=ln>76</span><span class=cl><span class=w>            </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=ln>77</span><span class=cl><span class=w>          </span><span class=nt>readinessProbe</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>78</span><span class=cl><span class=w>            </span><span class=nt>httpGet</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>79</span><span class=cl><span class=w>              </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/healthcheck</span><span class=w>
</span></span></span><span class=line><span class=ln>80</span><span class=cl><span class=w>              </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>12800</span><span class=w>
</span></span></span><span class=line><span class=ln>81</span><span class=cl><span class=w>            </span><span class=nt>initialDelaySeconds</span><span class=p>:</span><span class=w> </span><span class=m>30</span><span class=w>
</span></span></span><span class=line><span class=ln>82</span><span class=cl><span class=w>            </span><span class=nt>periodSeconds</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>
</span></span></span><span class=line><span class=ln>83</span><span class=cl><span class=w>            </span><span class=nt>timeoutSeconds</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=ln>84</span><span class=cl><span class=w>            </span><span class=nt>failureThreshold</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><strong>说明</strong>:</p><ul><li><code>SW_STORAGE=banyandb</code>: 使用 BanyanDB 作为存储后端</li><li><code>SW_RECEIVER_LOGGING</code>: 启用日志接收功能</li><li><code>SW_LOG_ANALYZER</code>: 启用日志分析功能</li><li><code>JAVA_OPTS</code>: 设置 JVM 内存参数，根据实际需求调整</li></ul></blockquote><p><strong>创建 OAP Service</strong></p><p>创建文件 <code>oap-service.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>grpc</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>11800</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>      </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>12800</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap</span><span class=w>
</span></span></span></code></pre></div><h4 id=2-部署-skywalking-ui>2. 部署 SkyWalking UI</h4><p><strong>创建 UI Deployment</strong></p><p>创建文件 <code>ui-deployment.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ui</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ui</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ui</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>ui</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>apache/skywalking-ui:10.3.0</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_OAP_ADDRESS</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>http://skywalking-oap.logging.svc.cluster.local:12800</span><span class=w>
</span></span></span></code></pre></div><p><strong>创建 UI Service</strong></p><p>创建文件 <code>ui-service.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ui</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ClusterIP</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ui</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span></code></pre></div><p><strong>创建 Ingress（可选）</strong></p><p>如果需要通过域名访问 SkyWalking UI，创建文件 <code>ingress.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Ingress</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ingress</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>    </span><span class=nt>traefik.ingress.kubernetes.io/router.entrypoints</span><span class=p>:</span><span class=w> </span><span class=l>web,websecure</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>    </span><span class=nt>traefik.ingress.kubernetes.io/router.tls</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>  </span><span class=nt>tls</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span>- <span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>        </span>- <span class=l>skywalking-dev.jobcher.com       </span><span class=w> </span><span class=c>#改为你自己的域名</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class=l>jobcher-com-tls          </span><span class=w> </span><span class=c>#改为你自己的证书</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-dev.jobcher.com     </span><span class=w> </span><span class=c>#改为你自己的域名</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>        </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>          </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>            </span><span class=nt>pathType</span><span class=p>:</span><span class=w> </span><span class=l>Prefix</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>            </span><span class=nt>backend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>              </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-ui</span><span class=w>
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w>                  </span><span class=nt>number</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span></code></pre></div><blockquote><p><strong>注意</strong>:</p><ul><li>请将 <code>skywalking-dev.jobcher.com</code> 替换为你的实际域名</li><li>请将 <code>jobcher-com-tls</code> 替换为你的 TLS 证书 Secret 名称</li><li>如果使用其他 Ingress Controller（如 Nginx），请相应修改 annotations</li></ul></blockquote><h4 id=3-部署-skywalking-组件>3. 部署 SkyWalking 组件</h4><p>在包含所有 SkyWalking YAML 文件的目录下执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>kubectl apply -f .
</span></span></code></pre></div><p>验证部署状态：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># 检查 OAP 状态</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>kubectl get pods -n logging <span class=p>|</span> grep skywalking-oap
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1># 检查 UI 状态</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>kubectl get pods -n logging <span class=p>|</span> grep skywalking-ui
</span></span><span class=line><span class=ln>6</span><span class=cl>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=c1># 查看 OAP 日志</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>kubectl logs -n logging -l <span class=nv>app</span><span class=o>=</span>skywalking-oap --tail<span class=o>=</span><span class=m>50</span>
</span></span></code></pre></div><blockquote><p><strong>提示</strong>: 如果使用 Ingress，部署完成后可以通过配置的域名访问 SkyWalking UI。也可以通过 <code>kubectl port-forward</code> 临时访问：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>kubectl port-forward -n logging svc/skywalking-ui 8080:8080
</span></span></code></pre></div><p>然后访问 <code>http://localhost:8080</code></p></blockquote><hr><h2 id=配置-skywalking-agent>配置 SkyWalking Agent</h2><p>要在 Java 应用中集成 SkyWalking，需要配置 SkyWalking Agent。本节以 Spring Boot 应用为例。</p><h3 id=1-添加-maven-依赖>1. 添加 Maven 依赖</h3><p>在项目的 <code>pom.xml</code> 文件中添加以下依赖：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=ln> 1</span><span class=cl>    <span class=c>&lt;!-- Logback 1.2.3 for SkyWalking compatibility --&gt;</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>      <span class=nt>&lt;groupId&gt;</span>ch.qos.logback<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>      <span class=nt>&lt;artifactId&gt;</span>logback-classic<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>      <span class=nt>&lt;version&gt;</span>1.2.3<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>      <span class=nt>&lt;groupId&gt;</span>ch.qos.logback<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>      <span class=nt>&lt;artifactId&gt;</span>logback-core<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>      <span class=nt>&lt;version&gt;</span>1.2.3<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=c>&lt;!-- SkyWalking Logback Toolkit for trace ID --&gt;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>      <span class=nt>&lt;groupId&gt;</span>org.apache.skywalking<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>      <span class=nt>&lt;artifactId&gt;</span>apm-toolkit-logback-1.x<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>      <span class=nt>&lt;version&gt;</span>9.5.0<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>    <span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></div><blockquote><p><strong>说明</strong>:</p><ul><li>Logback 1.2.3 版本与 SkyWalking Agent 9.5.0 兼容</li><li><code>apm-toolkit-logback-1.x</code> 用于在日志中自动添加 TraceID</li></ul></blockquote><h3 id=2-配置-logback>2. 配置 Logback</h3><p>修改 <code>logback-spring.xml</code> 文件，添加 SkyWalking 日志 Appender 和 TraceID 支持：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=ln> 1</span><span class=cl><span class=c>&lt;!-- SkyWalking Log Appender --&gt;</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>	<span class=nt>&lt;appender</span> <span class=na>name=</span><span class=s>&#34;SKYWALKING&#34;</span> <span class=na>class=</span><span class=s>&#34;org.apache.skywalking.apm.toolkit.log.logback.v1.x.log.GRPCLogClientAppender&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>		<span class=nt>&lt;encoder</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.encoder.LayoutWrappingEncoder&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>			<span class=nt>&lt;layout</span> <span class=na>class=</span><span class=s>&#34;org.apache.skywalking.apm.toolkit.log.logback.v1.x.mdc.TraceIdMDCPatternLogbackLayout&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>				<span class=nt>&lt;Pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} [%X{tid}] [%thread] %-5level %logger{36} -%msg%n<span class=nt>&lt;/Pattern&gt;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>			<span class=nt>&lt;/layout&gt;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>		<span class=nt>&lt;/encoder&gt;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>	<span class=nt>&lt;/appender&gt;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=nt>&lt;appender</span> <span class=na>name=</span><span class=s>&#34;console&#34;</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.ConsoleAppender&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=nt>&lt;filter</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.classic.filter.ThresholdFilter&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>        <span class=nt>&lt;level&gt;</span>Info<span class=nt>&lt;/level&gt;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>        <span class=nt>&lt;/filter&gt;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=nt>&lt;encoder</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.encoder.LayoutWrappingEncoder&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        <span class=nt>&lt;layout</span> <span class=na>class=</span><span class=s>&#34;org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>            <span class=nt>&lt;pattern&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} %contextName [%thread] %-5level %logger{36} :%line [%tid] - %msg%n<span class=nt>&lt;/pattern&gt;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>        <span class=nt>&lt;/layout&gt;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>        <span class=nt>&lt;/encoder&gt;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>    <span class=nt>&lt;/appender&gt;</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>
</span></span><span class=line><span class=ln>21</span><span class=cl>    <span class=nt>&lt;appender</span> <span class=na>name=</span><span class=s>&#34;file&#34;</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>        <span class=nt>&lt;file&gt;</span>${log.path}<span class=nt>&lt;/file&gt;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>        <span class=nt>&lt;rollingPolicy</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>        <span class=nt>&lt;fileNamePattern&gt;</span>${log.path}.%d{yyyy-MM-dd}.zip<span class=nt>&lt;/fileNamePattern&gt;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>        <span class=nt>&lt;/rollingPolicy&gt;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>        <span class=nt>&lt;encoder</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.encoder.LayoutWrappingEncoder&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>        <span class=nt>&lt;layout</span> <span class=na>class=</span><span class=s>&#34;org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>            <span class=nt>&lt;pattern&gt;</span>%date %level [%thread] %logger{36} [%file : %line] [%tid] %msg%n<span class=nt>&lt;/pattern&gt;</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>        <span class=nt>&lt;/layout&gt;</span>
</span></span><span class=line><span class=ln>30</span><span class=cl>        <span class=nt>&lt;/encoder&gt;</span>
</span></span><span class=line><span class=ln>31</span><span class=cl>    <span class=nt>&lt;/appender&gt;</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>
</span></span><span class=line><span class=ln>33</span><span class=cl><span class=c>&lt;!-- 其他配置内容 ... --&gt;</span>
</span></span><span class=line><span class=ln>34</span><span class=cl>
</span></span><span class=line><span class=ln>35</span><span class=cl>  <span class=nt>&lt;root</span> <span class=na>level=</span><span class=s>&#34;info&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>    <span class=nt>&lt;appender-ref</span> <span class=na>ref=</span><span class=s>&#34;SKYWALKING&#34;</span><span class=nt>/&gt;</span>  <span class=c>&lt;!-- 添加 SkyWalking 日志 Appender --&gt;</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>    <span class=nt>&lt;appender-ref</span> <span class=na>ref=</span><span class=s>&#34;console&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln>38</span><span class=cl>    <span class=nt>&lt;appender-ref</span> <span class=na>ref=</span><span class=s>&#34;file&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=ln>39</span><span class=cl>  <span class=nt>&lt;/root&gt;</span>
</span></span></code></pre></div><blockquote><p><strong>说明</strong>:</p><ul><li><code>SKYWALKING</code> Appender 会将日志发送到 SkyWalking OAP</li><li><code>TraceIdPatternLogbackLayout</code> 和 <code>TraceIdMDCPatternLogbackLayout</code> 会在日志中自动添加 TraceID</li><li>日志格式中的 <code>[%tid]</code> 或 <code>[%X{tid}]</code> 会显示追踪 ID</li></ul></blockquote><h3 id=3-kubernetes-部署配置>3. Kubernetes 部署配置</h3><h4 id=创建应用-deployment>创建应用 Deployment</h4><p>创建文件 <code>deployment.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=w>      </span><span class=nt>initContainers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>17</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-agent</span><span class=w>
</span></span></span><span class=line><span class=ln>18</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>apache/skywalking-java-agent:9.5.0-java8</span><span class=w>
</span></span></span><span class=line><span class=ln>19</span><span class=cl><span class=w>          </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-c&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=w>          </span><span class=nt>args</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>21</span><span class=cl><span class=w>            </span>- <span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=ln>22</span><span class=cl><span class=sd>              cp -r /skywalking/agent /shared/</span><span class=w>              
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>24</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-agent</span><span class=w>
</span></span></span><span class=line><span class=ln>25</span><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/shared</span><span class=w>
</span></span></span><span class=line><span class=ln>26</span><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>27</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln>28</span><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>dev/java-skywalking-test:latest </span><span class=w> </span><span class=c># 修改为你的应用镜像地址</span><span class=w>
</span></span></span><span class=line><span class=ln>29</span><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Always</span><span class=w>
</span></span></span><span class=line><span class=ln>30</span><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>31</span><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>9080</span><span class=w>
</span></span></span><span class=line><span class=ln>32</span><span class=cl><span class=w>              </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=ln>33</span><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>34</span><span class=cl><span class=w>            </span><span class=c># SkyWalking Agent 配置（通过 JAVA_TOOL_OPTIONS）</span><span class=w>
</span></span></span><span class=line><span class=ln>35</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_TOOL_OPTIONS</span><span class=w>
</span></span></span><span class=line><span class=ln>36</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=p>&gt;-</span><span class=sd>
</span></span></span><span class=line><span class=ln>37</span><span class=cl><span class=sd>                -javaagent:/skywalking/agent/skywalking-agent.jar
</span></span></span><span class=line><span class=ln>38</span><span class=cl><span class=sd>                -DSW_AGENT_NAME=java-skywalking-test
</span></span></span><span class=line><span class=ln>39</span><span class=cl><span class=sd>                -DSW_AGENT_COLLECTOR_BACKEND_SERVICES=skywalking-oap.logging.svc.cluster.local:11800
</span></span></span><span class=line><span class=ln>40</span><span class=cl><span class=sd>                -DSW_LOGGING_LEVEL=INFO
</span></span></span><span class=line><span class=ln>41</span><span class=cl><span class=sd>                -DSW_AGENT_AUTHENTICATION=
</span></span></span><span class=line><span class=ln>42</span><span class=cl><span class=sd>                -DSW_LOGGING_ENABLED=true
</span></span></span><span class=line><span class=ln>43</span><span class=cl><span class=sd>                -DSW_LOGGING_FILE_NAME=skywalking-api.log
</span></span></span><span class=line><span class=ln>44</span><span class=cl><span class=sd>                -DSW_LOGGING_DIR=/tmp/logs
</span></span></span><span class=line><span class=ln>45</span><span class=cl><span class=sd>                -DSW_AGENT_SAMPLE_N_PER_3_SECS=-1
</span></span></span><span class=line><span class=ln>46</span><span class=cl><span class=sd>                -DSW_AGENT_FORCE_RECONNECTION_PERIOD=10
</span></span></span><span class=line><span class=ln>47</span><span class=cl><span class=sd>                -DSW_AGENT_IS_OPEN_DEBUGGING_CLASS=true
</span></span></span><span class=line><span class=ln>48</span><span class=cl><span class=sd>                -DSW_AGENT_SPAN_LIMIT_PER_SEGMENT=500
</span></span></span><span class=line><span class=ln>49</span><span class=cl><span class=sd>                -DSW_AGENT_IGNORE_SUFFIX=.jpg,.jpeg,.js,.css,.png,.bmp,.gif,.ico,.mp3,.mp4,.html,.svg
</span></span></span><span class=line><span class=ln>50</span><span class=cl><span class=sd>                -DSW_GRPC_LOG_SERVER_HOST=skywalking-oap.logging.svc.cluster.local
</span></span></span><span class=line><span class=ln>51</span><span class=cl><span class=sd>                -DSW_GRPC_LOG_SERVER_PORT=11800</span><span class=w>                
</span></span></span><span class=line><span class=ln>52</span><span class=cl><span class=w>            </span><span class=c># SkyWalking Agent 环境变量配置（备用方式）</span><span class=w>
</span></span></span><span class=line><span class=ln>53</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_AGENT_COLLECTOR_BACKEND_SERVICES</span><span class=w>
</span></span></span><span class=line><span class=ln>54</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap.logging.svc.cluster.local:11800</span><span class=w>
</span></span></span><span class=line><span class=ln>55</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_AGENT_NAME</span><span class=w>
</span></span></span><span class=line><span class=ln>56</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln>57</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_LOGGING_LEVEL</span><span class=w>
</span></span></span><span class=line><span class=ln>58</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>INFO</span><span class=w>
</span></span></span><span class=line><span class=ln>59</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_LOGGING_ENABLED</span><span class=w>
</span></span></span><span class=line><span class=ln>60</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>61</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_AGENT_SAMPLE_N_PER_3_SECS</span><span class=w>
</span></span></span><span class=line><span class=ln>62</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;-1&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>63</span><span class=cl><span class=w>            </span><span class=c># 增加每个 segment 的 span 限制，避免 &#34;More than 300 spans&#34; 警告</span><span class=w>
</span></span></span><span class=line><span class=ln>64</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_AGENT_SPAN_LIMIT_PER_SEGMENT</span><span class=w>
</span></span></span><span class=line><span class=ln>65</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;500&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>66</span><span class=cl><span class=w>            </span><span class=c># 忽略静态资源的追踪</span><span class=w>
</span></span></span><span class=line><span class=ln>67</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_AGENT_IGNORE_SUFFIX</span><span class=w>
</span></span></span><span class=line><span class=ln>68</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;.jpg,.jpeg,.js,.css,.png,.bmp,.gif,.ico,.mp3,.mp4,.html,.svg&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>69</span><span class=cl><span class=w>            </span><span class=c># GRPCLogClientAppender 配置 - 日志发送到 OAP</span><span class=w>
</span></span></span><span class=line><span class=ln>70</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_GRPC_LOG_SERVER_HOST</span><span class=w>
</span></span></span><span class=line><span class=ln>71</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-oap.logging.svc.cluster.local</span><span class=w>
</span></span></span><span class=line><span class=ln>72</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SW_GRPC_LOG_SERVER_PORT</span><span class=w>
</span></span></span><span class=line><span class=ln>73</span><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;11800&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>74</span><span class=cl><span class=w>          </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>75</span><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-agent</span><span class=w>
</span></span></span><span class=line><span class=ln>76</span><span class=cl><span class=w>              </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/skywalking</span><span class=w>
</span></span></span><span class=line><span class=ln>77</span><span class=cl><span class=w>          </span><span class=c># 根据实际需求配置资源限制</span><span class=w>
</span></span></span><span class=line><span class=ln>78</span><span class=cl><span class=w>          </span><span class=c># resources:</span><span class=w>
</span></span></span><span class=line><span class=ln>79</span><span class=cl><span class=w>          </span><span class=c>#   requests:</span><span class=w>
</span></span></span><span class=line><span class=ln>80</span><span class=cl><span class=w>          </span><span class=c>#     memory: &#34;512Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>81</span><span class=cl><span class=w>          </span><span class=c>#     cpu: &#34;250m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>82</span><span class=cl><span class=w>          </span><span class=c>#   limits:</span><span class=w>
</span></span></span><span class=line><span class=ln>83</span><span class=cl><span class=w>          </span><span class=c>#     memory: &#34;1Gi&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>84</span><span class=cl><span class=w>          </span><span class=c>#     cpu: &#34;500m&#34;</span><span class=w>
</span></span></span><span class=line><span class=ln>85</span><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>86</span><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>skywalking-agent</span><span class=w>
</span></span></span><span class=line><span class=ln>87</span><span class=cl><span class=w>          </span><span class=nt>emptyDir</span><span class=p>:</span><span class=w> </span>{}<span class=w>
</span></span></span></code></pre></div><blockquote><p><strong>关键配置说明</strong>:</p><ul><li><code>initContainers</code>: 使用 init 容器将 SkyWalking Agent 复制到共享卷</li><li><code>JAVA_TOOL_OPTIONS</code>: 通过 JVM 参数启动 SkyWalking Agent</li><li><code>SW_AGENT_NAME</code>: 服务名称，在 SkyWalking UI 中显示</li><li><code>SW_AGENT_COLLECTOR_BACKEND_SERVICES</code>: OAP 服务地址</li><li><code>SW_AGENT_SAMPLE_N_PER_3_SECS=-1</code>: 采样率，-1 表示采样所有请求</li><li><code>SW_AGENT_SPAN_LIMIT_PER_SEGMENT=500</code>: 每个 segment 的 span 限制，避免警告</li><li><code>SW_GRPC_LOG_SERVER_HOST/PORT</code>: 日志发送到 OAP 的地址</li></ul></blockquote><p><strong>创建应用 Service</strong></p><p>创建文件 <code>service.yaml</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=ln> 1</span><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 4</span><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=ln> 6</span><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort</span><span class=w>
</span></span></span><span class=line><span class=ln> 8</span><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>java-skywalking-test</span><span class=w>
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=ln>11</span><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>9080</span><span class=w>
</span></span></span><span class=line><span class=ln>12</span><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>9080</span><span class=w>
</span></span></span><span class=line><span class=ln>13</span><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span><span class=w>
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>http</span><span class=w>
</span></span></span><span class=line><span class=ln>15</span><span class=cl><span class=w>      </span><span class=nt>nodePort</span><span class=p>:</span><span class=w> </span><span class=m>30980</span><span class=w>
</span></span></span></code></pre></div><h4 id=部署应用>部署应用</h4><p>在包含应用 YAML 文件的目录下执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>kubectl apply -f .
</span></span></code></pre></div><p>验证部署状态：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl><span class=c1># 检查 Pod 状态</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>kubectl get pods -n logging <span class=p>|</span> grep java-skywalking-test
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1># 查看应用日志</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>kubectl logs -n logging -l <span class=nv>app</span><span class=o>=</span>java-skywalking-test --tail<span class=o>=</span><span class=m>50</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=c1># 查看 SkyWalking Agent 日志</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>kubectl <span class=nb>exec</span> -n logging -it &lt;pod-name&gt; -- cat /tmp/logs/skywalking-api.log
</span></span></code></pre></div><hr><h2 id=验证和测试>验证和测试</h2><h3 id=1-访问-skywalking-ui>1. 访问 SkyWalking UI</h3><p>通过 Ingress 或 port-forward 访问 SkyWalking UI，你应该能看到：</p><ul><li><strong>服务列表</strong>: 显示已注册的服务（如 <code>java-skywalking-test</code>）</li><li><strong>服务拓扑</strong>: 可视化服务之间的调用关系</li><li><strong>追踪数据</strong>: 查看详细的调用链信息</li><li><strong>日志关联</strong>: 通过 TraceID 关联日志和追踪数据</li></ul><h3 id=2-测试应用追踪>2. 测试应用追踪</h3><p>访问你的应用并执行一些操作，然后在 SkyWalking UI 中：</p><ol><li>进入 <strong>Topology</strong> 页面查看服务拓扑</li><li>进入 <strong>Trace</strong> 页面查看追踪数据</li><li>进入 <strong>Log</strong> 页面查看关联的日志</li></ol><h3 id=3-常见问题排查>3. 常见问题排查</h3><p><strong>问题</strong>: 应用未出现在 SkyWalking UI 中</p><ul><li>检查 Pod 是否正常运行</li><li>检查 SkyWalking Agent 日志：<code>kubectl logs -n logging &lt;pod-name></code></li><li>确认 <code>SW_AGENT_COLLECTOR_BACKEND_SERVICES</code> 配置正确</li><li>确认 OAP 服务可访问：<code>kubectl get svc -n logging skywalking-oap</code></li></ul><p><strong>问题</strong>: 日志未发送到 SkyWalking</p><ul><li>检查 Logback 配置是否正确</li><li>确认 <code>SW_GRPC_LOG_SERVER_HOST</code> 和 <code>SW_GRPC_LOG_SERVER_PORT</code> 配置正确</li><li>查看 OAP 日志确认日志接收器是否正常</li></ul><p><strong>问题</strong>: TraceID 未出现在日志中</p><ul><li>确认已添加 <code>apm-toolkit-logback-1.x</code> 依赖</li><li>检查 Logback 配置中是否使用了 <code>TraceIdPatternLogbackLayout</code></li></ul><hr><h2 id=总结>总结</h2><p>本文介绍了如何在 Kubernetes 集群中部署 SkyWalking APM 监控系统，包括：</p><ol><li>✅ 部署 BanyanDB 和 etcd 作为存储后端</li><li>✅ 部署 SkyWalking OAP Server 和 UI</li><li>✅ 配置 Java 应用集成 SkyWalking Agent</li><li>✅ 配置日志关联和 TraceID 追踪</li></ol><p>通过以上配置，你可以获得完整的应用性能监控能力，包括分布式追踪、服务拓扑可视化和日志关联等功能。</p><blockquote><p><strong>提示</strong>: 生产环境建议：</p><ul><li>根据实际负载调整资源限制</li><li>配置持久化存储以确保数据安全</li><li>设置合适的采样率以平衡性能和监控需求</li><li>配置告警规则以便及时发现问题</li></ul></blockquote></div><div class="hb-content-panel-wrapper position-sticky mb-4 d-flex justify-content-center"><div class="hb-content-panel d-flex shadow w-auto rounded-5 bg-body"><div class=hb-content-panel-item><a href=#content-comments class="btn btn-link text-body" title=评论 role=button><svg aria-hidden="true" class="bi bi-chat-dotsbi bi-chat-dots hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M5 8A1 1 0 113 8a1 1 0 012 0m4 0A1 1 0 117 8a1 1 0 012 0m3 1a1 1 0 100-2 1 1 0 000 2"/><path d="m2.165 15.803.02-.004c1.83-.363 2.948-.842 3.468-1.105A9.06 9.06.0 008 15c4.418.0 8-3.134 8-7s-3.582-7-8-7-8 3.134-8 7c0 1.76.743 3.37 1.97 4.6a10.437 10.437.0 01-.524 2.318l-.003.011a10.722 10.722.0 01-.244.637c-.079.186.074.394.273.362a21.673 21.673.0 00.693-.125zm.8-3.108a1 1 0 00-.287-.801C1.618 10.83 1 9.468 1 8c0-3.192 3.004-6 7-6s7 2.808 7 6c0 3.193-3.004 6-7 6a8.06 8.06.0 01-2.088-.272 1 1 0 00-.711.074c-.387.196-1.24.57-2.634.893a10.97 10.97.0 00.398-2"/></svg></a></div><div class="hb-content-panel-item hb-content-panel-repo dropup-center dropup"><button class="btn btn-link text-body" type=button title=编辑 data-bs-toggle=dropdown aria-expanded=false><svg aria-hidden="true" class="bi bi-pencil-squarebi bi-pencil-square hi-svg-inline" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M15.502 1.94a.5.5.0 010 .706L14.459 3.69l-2-2L13.502.646a.5.5.0 01.707.0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5.0 00-.121.196l-.805 2.414a.25.25.0 00.316.316l2.414-.805a.5.5.0 00.196-.12l6.813-6.814z"/><path fill-rule="evenodd" d="M1 13.5A1.5 1.5.0 002.5 15h11a1.5 1.5.0 001.5-1.5v-6a.5.5.0 00-1 0v6a.5.5.0 01-.5.5h-11a.5.5.0 01-.5-.5v-11a.5.5.0 01.5-.5H9a.5.5.0 000-1H2.5A1.5 1.5.0 001 2.5z"/></svg></button><ul class=dropdown-menu><li><a class=dropdown-item href=https://github.com/jobcher/new-blog/edit/main/content/blog/posts/kubernetes/k8sinstall-skywalking.md target=_blank rel="noreferrer noopener"><svg aria-hidden="true" class="bi bi-pencilbi bi-pencil hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12.146.146a.5.5.0 01.708.0l3 3a.5.5.0 010 .708l-10 10a.5.5.0 01-.168.11l-5 2a.5.5.0 01-.65-.65l2-5a.5.5.0 01.11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5.0 01.5.5v.5h.5a.5.5.0 01.5.5v.5h.293zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5.0 015 12.5V12h-.5a.5.5.0 01-.5-.5V11h-.5a.5.5.0 01-.468-.325z"/></svg>编辑本页</a></li><li><a class=dropdown-item href=https://github.com/jobcher/new-blog/blob/main/content/blog/posts/kubernetes/k8sinstall-skywalking.md target=_blank rel="noreferrer noopener"><svg aria-hidden="true" class="bi bi-eyebi bi-eye hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13.133 13.133.0 011.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13.133 13.133.0 0114.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12.0-3.879-1.168-5.168-2.457A13.134 13.134.0 011.172 8z"/><path d="M8 5.5a2.5 2.5.0 100 5 2.5 2.5.0 000-5M4.5 8a3.5 3.5.0 117 0 3.5 3.5.0 01-7 0"/></svg>查看页面源码</a></li><li><a class=dropdown-item href=https://github.com/jobcher/new-blog/commit/349e23019d08255256cbc79fa251f69193a7e5e8 target=_blank rel="noreferrer noopener"><svg aria-hidden="true" class="bi bi-gitbi bi-git hi-svg-inline me-2" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M15.698 7.287 8.712.302a1.03 1.03.0 00-1.457.0l-1.45 1.45 1.84 1.84a1.223 1.223.0 011.55 1.56l1.773 1.774a1.224 1.224.0 011.267 2.025 1.226 1.226.0 01-2.002-1.334L8.58 5.963v4.353a1.226 1.226.0 11-1.008-.036V5.887a1.226 1.226.0 01-.666-1.608L5.093 2.465.303 7.255a1.03 1.03.0 000 1.457l6.986 6.986a1.03 1.03.0 001.457.0l6.953-6.953a1.031 1.031.0 000-1.457"/></svg>feat: add comprehensive OpenClaw guide with featured image</a></li></ul></div></div></div><ul class="hb-blog-post-nav nav justify-content-between hb-module"><li class="nav-item my-1"><a class="nav-link p-0 d-flex align-items-center" href=/k8sinstall-promtail/><svg aria-hidden="true" class="bi bi-arrow-left-circlebi bi-arrow-left-circle hi-svg-inline me-2" fill="currentcolor" height="1.5em" viewBox="0 0 16 16" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0m-4.5-.5a.5.5.0 010 1H5.707l2.147 2.146a.5.5.0 01-.708.708l-3-3a.5.5.0 010-.708l3-3a.5.5.0 11.708.708L5.707 7.5z"/></svg>Kubernetes — promtail + loki + grafana 日志系统部署</a></li><li class="nav-item my-1"><a class="nav-link p-0 d-flex align-items-center" href=/openclaw-guide/>OpenClaw 全能指南：从安装到进阶自动化实战<svg aria-hidden="true" class="bi bi-arrow-right-circlebi bi-arrow-right-circle hi-svg-inline ms-2" fill="currentcolor" height="1.5em" viewBox="0 0 16 16" width="1.5em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0M4.5 7.5a.5.5.0 000 1h5.793l-2.147 2.146a.5.5.0 00.708.708l3-3a.5.5.0 000-.708l-3-3a.5.5.0 10-.708.708L10.293 7.5z"/></svg></a></li></ul><div class="hb-blog-related-posts slide hb-module p-1"><div class="slide-inner row row-cols-1 row-cols-xl-2 gx-2"><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8sinstall-promtail/><picture><source srcset=/images/promtail_hu2ff0eafacaad29266b4ff0554fe8d5ce_5987_318x159_resize_q75_h2_box.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/promtail.86d5d2ad0d4fac1aba275082631c75a9.jpg alt="Kubernetes — promtail + loki + grafana 日志系统部署" loading=lazy height=159 width=318></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — promtail + loki + grafana 日志系统部署" href=/k8sinstall-promtail/>Kubernetes — promtail + loki + grafana 日志系统部署</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8sinstall-traefik/><picture><source srcset=/images/traefik-logo_hu72bfdfd76990a5f003cd2061e41c8725_54130_1178x1180_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/traefik-logo.ad4f194fae0e0691790aae1bfc61e515.png alt="Kubernetes — metalLB + Traefik 部署" loading=lazy height=1180 width=1178></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — metalLB + Traefik 部署" href=/k8sinstall-traefik/>Kubernetes — metalLB + Traefik 部署</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8sinstall-cert/><picture><source srcset=/images/cert-manager_hufb51d2b9a565dcf9d405a1d0a723ac76_24020_1200x630_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/cert-manager.e557703bdc8d65e4ae9008b8700327f3.png alt="Kubernetes — SSL 证书自动更新" loading=lazy height=630 width=1200></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — SSL 证书自动更新" href=/k8sinstall-cert/>Kubernetes — SSL 证书自动更新</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8sinstall-rke2/><picture><source srcset=/images/kubernetes0install_hu87d3ee1bc1218931d764aa396fe927b5_65483_1200x600_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/kubernetes0install.c2c1a6f30736a901732f979ae00a6d92.png alt="Kubernetes — RKE2 + kube-vip + cilium 部署" loading=lazy height=600 width=1200></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — RKE2 + kube-vip + cilium 部署" href=/k8sinstall-rke2/>Kubernetes — RKE2 + kube-vip + cilium 部署</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8s18/><picture><source srcset=/images/metallb_hu337a8a2293c76b216f31c98d40336f61_28736_796x379_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/metallb.3b0dc3fefff108149d3134b4d5045c0d.png alt="metallb + ingress-nginx + argocd 本地部署" loading=lazy height=379 width=796></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="metallb + ingress-nginx + argocd 本地部署" href=/k8s18/>metallb + ingress-nginx + argocd 本地部署</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8sinstall-1.17.9/><picture><source srcset=/images/kubernetes0install_hu87d3ee1bc1218931d764aa396fe927b5_65483_1200x600_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/kubernetes0install.c2c1a6f30736a901732f979ae00a6d92.png alt="Kubernetes — k8s 手动安装 1.17.9" loading=lazy height=600 width=1200></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — k8s 手动安装 1.17.9" href=/k8sinstall-1.17.9/>Kubernetes — k8s 手动安装 1.17.9</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/argocd/><picture><source srcset=/images/argo-logo_hu9d543c37edb30adbab7de537796cbca9_3243_297x170_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/argo-logo.cd6e85198b47eab1a1c5c92e9f84f5de.png alt="Argo cd 安装和部署" loading=lazy height=170 width=297></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Argo cd 安装和部署" href=/argocd/>Argo cd 安装和部署</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8s17/><picture><source srcset=/images/kubecost-215b96ad_hubc1db145a6c4a9de4a027c9011c631c7_272110_2534x1440_resize_q75_h2_box_3.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/kubecost-215b96ad.e26bb1593becea53b33f87b583ac7def.png alt="Kubernetes — kubecost 分析 Kubernetes 成本" loading=lazy height=1440 width=2534></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — kubecost 分析 Kubernetes 成本" href=/k8s17/>Kubernetes — kubecost 分析 Kubernetes 成本</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/ansible-ceph/><div class="hb-blog-post-card-img-none d-flex align-items-center justify-content-center">JOBCHER BLOG</div></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title=Ansible部署ceph集群 href=/ansible-ceph/>Ansible部署ceph集群</a></div></div></div></div><div class=slide-item><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/k8s16/><div class="hb-blog-post-card-img-none d-flex align-items-center justify-content-center">JOBCHER BLOG</div></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Kubernetes — 更新证书" href=/k8s16/>Kubernetes — 更新证书</a></div></div></div></div></div><button class=slide-control-left>
<svg aria-hidden="true" class="bi bi-arrow-left-circlebi bi-arrow-left-circle hi-svg-inline slide-control-left-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0m-4.5-.5a.5.5.0 010 1H5.707l2.147 2.146a.5.5.0 01-.708.708l-3-3a.5.5.0 010-.708l3-3a.5.5.0 11.708.708L5.707 7.5z"/></svg>
<span class=visually-hidden>向左</span>
</button>
<button class=slide-control-right>
<svg aria-hidden="true" class="bi bi-arrow-right-circlebi bi-arrow-right-circle hi-svg-inline slide-control-right-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0M4.5 7.5a.5.5.0 000 1h5.793l-2.147 2.146a.5.5.0 00.708.708l3-3a.5.5.0 000-.708l-3-3a.5.5.0 10-.708.708L10.293 7.5z"/></svg>
<span class=visually-hidden>向右</span></button></div><div id=content-comments class="hb-blog-post-comments hb-module mb-3"><div id=twikoo-comments></div></div></div></div></div><div class="hb-blog-sidebar pe-lg-1"><div class="hb-blog-sidebar-profile hb-module d-flex flex-column justify-content-center align-items-center"><picture><source srcset=/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_95b129ec0c9ac480b7db044054d215d0.webp type=image/webp><img class="hb-blog-sidebar-profile-img rounded-circle img-fluid mb-3" src=https://www.jobcher.com/images/logo_hu212c4235ec694c68a44045c031d18f63_184363_100x0_resize_box_3.24b0c3ba128acac45603f551e9a391d0.png alt loading=lazy height=100 width=100></picture><p class="hb-blog-sidebar-profile-title text-center h5 mb-2">打工人日志</p><p class="hb-blog-sidebar-profile-desc text-center mb-2">A week is 2% of the year</p><p class="hb-blog-sidebar-profile-meta mb-0"><span class=mx-1><svg aria-hidden="true" class="bi bi-geo-altbi bi-geo-alt hi-svg-inline me-1" fill="currentcolor" height="1em" viewBox="0 0 16 16" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12.166 8.94c-.524 1.062-1.234 2.12-1.96 3.07A31.493 31.493.0 018 14.58a31.481 31.481.0 01-2.206-2.57c-.726-.95-1.436-2.008-1.96-3.07C3.304 7.867 3 6.862 3 6a5 5 0 0110 0c0 .862-.305 1.867-.834 2.94M8 16s6-5.686 6-10A6 6 0 002 6c0 4.314 6 10 6 10"/><path d="M8 8a2 2 0 110-4 2 2 0 010 4m0 1a3 3 0 100-6 3 3 0 000 6"/></svg>Earth</span></p><div class="hb-footer-socials d-flex mb-0 mt-1 justify-content-center"><a class="hb-social p-2" href=https://github.com/jobcher target=_blank rel="nofollow me" title=GitHub><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
</a><a class="hb-social p-2" href=/index.xml target=_blank rel="nofollow me" title=RSS><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg>
</a><a class="hb-social p-2" href=https://twitter.com/jobcher1 target=_blank rel="nofollow me" title=推特><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:#1d9bf0" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636.0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94.0 010 19.539a9.88 9.88.0 007.287-2.041 4.93 4.93.0 01-4.6-3.42 4.916 4.916.0 002.223-.084A4.926 4.926.0 01.96 9.167v-.062a4.887 4.887.0 002.235.616A4.928 4.928.0 011.67 3.148 13.98 13.98.0 0011.82 8.292a4.929 4.929.0 018.39-4.49 9.868 9.868.0 003.128-1.196A4.941 4.941.0 0121.173 5.33 9.828 9.828.0 0024 4.555a10.019 10.019.0 01-2.457 2.549z"/></svg></a></div></div><a href=https://sub.jobcher.com/ style=text-decoration:none;color:inherit><div class="hb-module text-center bg-primary text-white p-3">点击订阅 获取最新文章</div></a><br><div class="hb-module text-center"><a href=https://www.foreverblog.cn/go.html target=_blank><img src=https://img.foreverblog.cn/wormhole_3_tp.gif alt style=width:auto;height:32px title=穿梭虫洞-随机访问十年之约友链博客></a></div><div class="hb-blog-sidebar-posts hb-module"><ul class="nav nav-pills nav-fill" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=featured-posts-tab data-bs-toggle=tab data-bs-target=#featured-posts type=button role=tab aria-controls=featured-posts aria-selected=true>
精选文章</button></li><li class=nav-item role=presentation><button class=nav-link id=recent-posts-tab data-bs-toggle=tab data-bs-target=#recent-posts type=button role=tab aria-controls=recent-posts aria-selected=true>
最近文章</button></li></ul><div class="tab-content mt-2"><div class="tab-pane active" id=featured-posts role=tabpanel aria-labelledby=featured-posts-tab tabindex=0><div class=slide><div class="slide-inner row row-cols-1"><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/featured-post-without-image/><div class="hb-blog-post-card-img-none d-flex align-items-center justify-content-center">JOBCHER BLOG</div></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="Featured Post without Image" href=/featured-post-without-image/>Featured Post without Image</a></div></div></div></div></div><button class=slide-control-left>
<svg aria-hidden="true" class="bi bi-arrow-left-circlebi bi-arrow-left-circle hi-svg-inline slide-control-left-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0m-4.5-.5a.5.5.0 010 1H5.707l2.147 2.146a.5.5.0 01-.708.708l-3-3a.5.5.0 010-.708l3-3a.5.5.0 11.708.708L5.707 7.5z"/></svg>
<span class=visually-hidden>向左</span>
</button>
<button class=slide-control-right>
<svg aria-hidden="true" class="bi bi-arrow-right-circlebi bi-arrow-right-circle hi-svg-inline slide-control-right-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0M4.5 7.5a.5.5.0 000 1h5.793l-2.147 2.146a.5.5.0 00.708.708l3-3a.5.5.0 000-.708l-3-3a.5.5.0 10-.708.708L10.293 7.5z"/></svg>
<span class=visually-hidden>向右</span></button></div></div><div class="tab-pane slide" id=recent-posts role=tabpanel aria-labelledby=recent-posts-tab tabindex=0><div class=slide><div class="slide-inner row row-cols-1"><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/openclaw-guide/><picture><source srcset=/openclaw-guide/featured_hua9f17a33bdd02e39c6785324ec96e2d2_1900315_80ffc27553cc2d2fa2d3ed8bd9797359.webp type=image/webp><img class=hb-blog-post-card-img src=https://www.jobcher.com/openclaw-guide/featured_hua9f17a33bdd02e39c6785324ec96e2d2_1900315_0x360_resize_box_3.e5032a3bb7cdfd8623b39808fd7f10ad.png alt="OpenClaw 全能指南：从安装到进阶自动化实战" loading=lazy height=360 width=660></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="OpenClaw 全能指南：从安装到进阶自动化实战" href=/openclaw-guide/>OpenClaw 全能指南：从安装到进阶自动化实战</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/new/daily/github_trending_2026-02-04/><picture><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/wallpaper/2026-02-04.jpg.0c649afcac4f778a7d994312ad5b5f06.webp alt="2026-02-04 打工人日报" loading=lazy height=1080 width=1920></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="2026-02-04 打工人日报" href=/new/daily/github_trending_2026-02-04/>2026-02-04 打工人日报</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/new/daily/github_trending_2026-02-03/><picture><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/wallpaper/2026-02-03.jpg.f34d737b285487c725742af6736281b4.webp alt="2026-02-03 打工人日报" loading=lazy height=1080 width=1920></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="2026-02-03 打工人日报" href=/new/daily/github_trending_2026-02-03/>2026-02-03 打工人日报</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/new/daily/github_trending_2026-02-02/><picture><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/wallpaper/2026-02-02.jpg.1621de9be3ea7852347d310fb72b2e1b.webp alt="2026-02-02 打工人日报" loading=lazy height=1080 width=1920></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="2026-02-02 打工人日报" href=/new/daily/github_trending_2026-02-02/>2026-02-02 打工人日报</a></div></div></div></div><div class="slide-item px-0"><div class="hb-blog-post-card card border-0 overflow-hidden h-100 bg-transparent mb-0"><a class="card-img-top overflow-hidden border border-secondary-subtle text-body text-decoration-none mt-2" href=/new/daily/github_trending_2026-02-01/><picture><img class=hb-blog-post-card-img src=https://www.jobcher.com/images/wallpaper/2026-02-01.jpg.6429c8377e5b4a5babc2695a702be93d.webp alt="2026-02-01 打工人日报" loading=lazy height=1080 width=1920></picture></a><div class="card-body px-0 py-2 d-flex flex-column"><div class="hb-blog-post-title card-title h5 py-1"><a class="hb-blog-post-title-link d-block" title="2026-02-01 打工人日报" href=/new/daily/github_trending_2026-02-01/>2026-02-01 打工人日报</a></div></div></div></div></div><button class=slide-control-left>
<svg aria-hidden="true" class="bi bi-arrow-left-circlebi bi-arrow-left-circle hi-svg-inline slide-control-left-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0m-4.5-.5a.5.5.0 010 1H5.707l2.147 2.146a.5.5.0 01-.708.708l-3-3a.5.5.0 010-.708l3-3a.5.5.0 11.708.708L5.707 7.5z"/></svg>
<span class=visually-hidden>向左</span>
</button>
<button class=slide-control-right>
<svg aria-hidden="true" class="bi bi-arrow-right-circlebi bi-arrow-right-circle hi-svg-inline slide-control-right-icon" fill="currentcolor" height="2em" viewBox="0 0 16 16" width="2em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M1 8a7 7 0 1014 0A7 7 0 001 8m15 0A8 8 0 110 8a8 8 0 0116 0M4.5 7.5a.5.5.0 000 1h5.793l-2.147 2.146a.5.5.0 00.708.708l3-3a.5.5.0 000-.708l-3-3a.5.5.0 10-.708.708L10.293 7.5z"/></svg>
<span class=visually-hidden>向右</span></button></div></div></div></div><div class="hb-blog-sidebar-taxonomies hb-module"><ul class="nav nav-pills nav-justified mb-2" role=tablist><li class=nav-item role=presentation><button class="nav-link active" id=taxonomy-authors-tab data-bs-toggle=tab data-bs-target=#taxonomy-authors-tab-pane type=button role=tab aria-controls=taxonomy-authors-tab-pane aria-selected=true>作者</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomy-categories-tab data-bs-toggle=tab data-bs-target=#taxonomy-categories-tab-pane type=button role=tab aria-controls=taxonomy-categories-tab-pane aria-selected=false>分类</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomy-series-tab data-bs-toggle=tab data-bs-target=#taxonomy-series-tab-pane type=button role=tab aria-controls=taxonomy-series-tab-pane aria-selected=false>专栏</button></li><li class=nav-item role=presentation><button class=nav-link id=taxonomy-tags-tab data-bs-toggle=tab data-bs-target=#taxonomy-tags-tab-pane type=button role=tab aria-controls=taxonomy-tags-tab-pane aria-selected=false>标签</button></li></ul><div class=tab-content><div class="tab-pane fade show active" id=taxonomy-authors-tab-pane role=tabpanel aria-labelledby=taxonomy-authors-tab tabindex=0><a class="taxonomy-term taxonomy-term-authors btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/authors/jobcher/><span class=taxonomy-term-title>jobcher</span>
<small class="taxonomy-term-count border rounded px-1">369</small></a></div><div class="tab-pane fade" id=taxonomy-categories-tab-pane role=tabpanel aria-labelledby=taxonomy-categories-tab tabindex=0><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/%E6%97%A5%E6%8A%A5/><span class=taxonomy-term-title>日报</span>
<small class="taxonomy-term-count border rounded px-1">765</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/github/><span class=taxonomy-term-title>github</span>
<small class="taxonomy-term-count border rounded px-1">167</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/%E6%97%A5%E5%B8%B8/><span class=taxonomy-term-title>日常</span>
<small class="taxonomy-term-count border rounded px-1">39</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/k8s/><span class=taxonomy-term-title>k8s</span>
<small class="taxonomy-term-count border rounded px-1">36</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/%E5%9F%BA%E7%A1%80/><span class=taxonomy-term-title>基础</span>
<small class="taxonomy-term-count border rounded px-1">18</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/gitlab/><span class=taxonomy-term-title>gitlab</span>
<small class="taxonomy-term-count border rounded px-1">15</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/%E9%97%AE%E9%A2%98%E5%BA%93/><span class=taxonomy-term-title>问题库</span>
<small class="taxonomy-term-count border rounded px-1">13</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/docker/><span class=taxonomy-term-title>docker</span>
<small class="taxonomy-term-count border rounded px-1">11</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/%E7%A6%8F%E5%88%A9/><span class=taxonomy-term-title>福利</span>
<small class="taxonomy-term-count border rounded px-1">9</small>
</a><a class="taxonomy-term taxonomy-term-categories btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/categories/web-%E6%9C%8D%E5%8A%A1%E5%99%A8/><span class=taxonomy-term-title>web 服务器</span>
<small class="taxonomy-term-count border rounded px-1">8</small></a></div><div class="tab-pane fade" id=taxonomy-series-tab-pane role=tabpanel aria-labelledby=taxonomy-series-tab tabindex=0><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E6%97%A5%E6%8A%A5/><span class=taxonomy-term-title>日报</span>
<small class="taxonomy-term-count border rounded px-1">765</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/github/><span class=taxonomy-term-title>github</span>
<small class="taxonomy-term-count border rounded px-1">167</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E6%97%A5%E5%B8%B8%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>日常系列</span>
<small class="taxonomy-term-count border rounded px-1">39</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/k8s%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>k8s入门系列</span>
<small class="taxonomy-term-count border rounded px-1">35</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E9%97%AE%E9%A2%98%E5%BA%93%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>问题库系列</span>
<small class="taxonomy-term-count border rounded px-1">21</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>基础知识系列</span>
<small class="taxonomy-term-count border rounded px-1">18</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/git%E5%85%A5%E9%97%A8%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>git入门系列</span>
<small class="taxonomy-term-count border rounded px-1">15</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E7%A6%8F%E5%88%A9%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>福利系列</span>
<small class="taxonomy-term-count border rounded px-1">9</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E5%91%A8%E6%8A%A5%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>周报系列</span>
<small class="taxonomy-term-count border rounded px-1">8</small>
</a><a class="taxonomy-term taxonomy-term-series btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/series/%E8%BF%90%E7%BB%B4%E7%9B%91%E6%8E%A7%E7%B3%BB%E5%88%97/><span class=taxonomy-term-title>运维监控系列</span>
<small class="taxonomy-term-count border rounded px-1">8</small></a></div><div class="tab-pane fade" id=taxonomy-tags-tab-pane role=tabpanel aria-labelledby=taxonomy-tags-tab tabindex=0><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/%E6%97%A5%E6%8A%A5/><span class=taxonomy-term-title>日报</span>
<small class="taxonomy-term-count border rounded px-1">765</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/github/><span class=taxonomy-term-title>github</span>
<small class="taxonomy-term-count border rounded px-1">167</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/k8s/><span class=taxonomy-term-title>k8s</span>
<small class="taxonomy-term-count border rounded px-1">35</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/daliy/><span class=taxonomy-term-title>daliy</span>
<small class="taxonomy-term-count border rounded px-1">26</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/%E8%BF%90%E7%BB%B4/><span class=taxonomy-term-title>运维</span>
<small class="taxonomy-term-count border rounded px-1">16</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/error/><span class=taxonomy-term-title>error</span>
<small class="taxonomy-term-count border rounded px-1">13</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/docker/><span class=taxonomy-term-title>docker</span>
<small class="taxonomy-term-count border rounded px-1">11</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/gitlab/><span class=taxonomy-term-title>gitlab</span>
<small class="taxonomy-term-count border rounded px-1">11</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/linux/><span class=taxonomy-term-title>linux</span>
<small class="taxonomy-term-count border rounded px-1">10</small>
</a><a class="taxonomy-term taxonomy-term-tags btn btn-sm btn-outline-secondary p-1 me-1 mb-1" href=/tags/nginx/><span class=taxonomy-term-title>nginx</span>
<small class="taxonomy-term-count border rounded px-1">8</small></a></div></div></div></div></div></div><footer class="hb-footer pt-4 pt-md-5 pb-2 pb-md-3 bg-body-tertiary"><div class="container-fluid container-lg px-4 px-md-3"><div class=row><div class="hb-footer-site-info col mb-2 text-center"><div class=h5>打工人日志</div><ul class="list-unstyled small mb-2"><li class=mt-2>A week is 2% of the year</li><li class=mt-2>Copyright © 2022-2026 All Rights Reserved.</li><li class=mt-2>Built with ❤️ from <a class=text-body-emphasis href=https://gohugo.io/ target=_blank rel=external title=Hugo>Hugo</a>, <a class=text-body-emphasis href=https://hugomods.com/ target=_blank rel=external title=HugoMods>HugoMods</a> and <a class=text-body-emphasis href=https://hbstack.dev/ target=_blank rel=external title="HB Framework">HB Framework</a>.</li></ul><div class="hb-footer-socials d-flex mb-2 justify-content-center"><a class="hb-social p-2" href=https://github.com/jobcher target=_blank rel="nofollow me" title=GitHub><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:%!s(bool=true)" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63.0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577.0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93.0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176.0.0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22.0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22.0 1.606-.015 2.896-.015 3.286.0.315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
</a><a class="hb-social p-2" href=/index.xml target=_blank rel="nofollow me" title=RSS><svg aria-hidden="true" class="bi bi-rss-fillbi bi-rss-fill hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" style="color:%!s(bool=true)" viewBox="0 0 16 16" width="1.75em" xmlns="http://www.w3.org/2000/svg"><path d="M2 0A2 2 0 000 2v12a2 2 0 002 2h12a2 2 0 002-2V2a2 2 0 00-2-2zm1.5 2.5c5.523.0 10 4.477 10 10a1 1 0 11-2 0 8 8 0 00-8-8 1 1 0 010-2m0 4a6 6 0 016 6 1 1 0 11-2 0 4 4 0 00-4-4 1 1 0 010-2m.5 7a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg>
</a><a class="hb-social p-2" href=https://twitter.com/jobcher1 target=_blank rel="nofollow me" title=推特><svg aria-hidden="true" class="hi-svg-inline hb-social-icon" fill="currentcolor" height="1.75em" role="img" style="color:#1d9bf0" viewBox="0 0 24 24" width="1.75em" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M21.543 7.104c.015.211.015.423.015.636.0 6.507-4.954 14.01-14.01 14.01v-.003A13.94 13.94.0 010 19.539a9.88 9.88.0 007.287-2.041 4.93 4.93.0 01-4.6-3.42 4.916 4.916.0 002.223-.084A4.926 4.926.0 01.96 9.167v-.062a4.887 4.887.0 002.235.616A4.928 4.928.0 011.67 3.148 13.98 13.98.0 0011.82 8.292a4.929 4.929.0 018.39-4.49 9.868 9.868.0 003.128-1.196A4.941 4.941.0 0121.173 5.33 9.828 9.828.0 0024 4.555a10.019 10.019.0 01-2.457 2.549z"/></svg></a></div></div></div></div></footer><script src=/js/hb.bb28d1843c11c3105e208428f85dd034633316c205fd89433f22d28cd634ff03.js integrity="sha256-uyjRhDwRwxBeIIQo+F3QNGMzFsIF/YlDPyLSjNY0/wM=" defer></script><script src=https://cdn.staticfile.org/twikoo/1.6.16/twikoo.all.min.js></script><script>twikoo.init({envId:"https://comments.jobcher.com/",el:"#twikoo-comments",region:"",path:location.pathname,lang:"zh-hans"})</script><script src=/js/search.ca233e5730071d80a2d5dfe774f43fcbfab38671ad84db248aa4134f47a18425.js defer></script><script>"serviceWorker"in navigator&&window.addEventListener("DOMContentLoaded",function(){navigator.serviceWorker.register("/sw.js")})</script></body></html>